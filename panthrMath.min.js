!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require){window.panthrMath=require("./index.js")},{"./index.js":2}],2:[function(require,module){!function(define){"use strict";define(function(require){var panthrMath,mixin;return mixin=require("./panthrMath/utils").mixin,panthrMath={},panthrMath.C=require("./panthrMath/constants"),panthrMath.Polynomial=require("./panthrMath/polynomial"),panthrMath.Rational=require("./panthrMath/rational"),mixin(panthrMath,require("./panthrMath/basicfunc"),require("./panthrMath/distributions")),panthrMath})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"./panthrMath/basicfunc":15,"./panthrMath/constants":16,"./panthrMath/distributions":17,"./panthrMath/polynomial":26,"./panthrMath/rational":27,"./panthrMath/utils":32}],3:[function(require,module){!function(define){"use strict";define(function(){function bd0(x,np){var ej,j,s,sTemp,v;if(Math.abs(x-np)<.1*(x+np)){for(v=(x-np)/(x+np),s=(x-np)*v,ej=2*x*v,j=1;1e4>j;j+=1){if(ej*=v*v,sTemp=s+ej/(2*j+1),sTemp===s)return sTemp;s=sTemp}throw new Error("bd0(x, np) made it to 10000 ...")}return x*Math.log(x/np)+np-x}return{bd0:bd0}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{}],4:[function(require,module){!function(define){"use strict";define(function(require){function bcorr(a,b){return a>b?bcorr(b,a):stirlerr(a)+algdiv(a,b)+(a+b-.5)*Math.log(1+a/b)+a*(Math.log(b)-1)}function brcomp(a,b,x,y){var lambda;return lambda=a-(a+b)*x,Math.min(a,b)<8?a*Math.log(x)+b*Math.log(y)-lbeta(a,b):.5*(Math.log(a)+Math.log(b)-C.log2pi-Math.log(a+b))-a*phi(1-lambda/a)-b*phi(1+lambda/b)-bcorr(a,b)}function fromLower(lp){return{lower:lp,upper:log1p(-Math.exp(lp))}}function fromUpper(lq){return{lower:log1p(-Math.exp(lq)),upper:lq}}function tailFlip(o){return{lower:o.upper,upper:o.lower}}function bpser(a,b,x){var c,ser;return c=1,ser=a*series(function(i){return 0===i?0:(c=c*(1-b/i)*x,c/(a+i))}),ser=ser>-1?log1p(ser):-1/0,-lbeta(a,b)+a*Math.log(x)-Math.log(a)+ser}function bup(a,b,x,y,n){var logSeries;return logSeries=Math.log(series(function(i,v){return 0===i?1:v*x*(1+(b-1)/(a+i))},n)),a*Math.log(x)+b*Math.log(y)-lbeta(a,b)-Math.log(a)+logSeries}function bgrat(a,b,x){var T,fTs,u,logH,logM,lnx2s,lnx2sn,ps,cs,j,ser;return T=a+.5*(b-1),fTs=1/(4*T*T),u=-T*Math.log(x),logH=Math.log(b)+log1p(gam1(b))+b*Math.log(u)-u,logM=logH-(algdiv(b,a)+b*Math.log(T)),cs=[1],ps=[1],lnx2s=.5*Math.log(x),lnx2s*=lnx2s,lnx2sn=1,j=gratR(b,u,logH),ser=Math.log(series(function(n){var mbmn=-n;return n>0&&(j=(b+2*n-2)*(b+2*n-2+1)*j+(u+b+2*n-2+1)*lnx2sn,j*=fTs,cs[n]=cs[n-1]/(2*n)/(2*n+1),ps[n]=(b-1)*cs[n]+1/n*series(function(m){return 0===m?0:(mbmn+=b,mbmn*cs[m]*ps[n-m])},n),lnx2sn*=lnx2s),ps[n]*j})),logM+ser}function bfrac(a,b,x,y){var lambda;return lambda=a-(a+b)*x,brcomp(a,b,x,y)+Math.log(contFrac(function(i){var n=i-1;return 0===i?0:n+n*(b-n)*x/(a+2*n-1)+(a+n)/(a+2*n+1)*(lambda+1+n*(1+y))},function(i){var n=i-1;return 1===i?1:(a+n-1)*(a+b+n-1)/(a+2*n-1)/(a+2*n-1)*n*(b-n)*x*x}))}function basym(a,b,x,y){var z,p,q,bg,bgn,Ls,as,bs,cs,es,r,ab,sgn,abnp1,root2z,root2znm1,ser;return p=a/(a+b),q=b/(a+b),bg=Math.sqrt(b>a?q/a:p/b),bgn=1/bg,z=Math.sqrt(a*phi(x/p)+b*phi(y/q)),Ls=[],as=[],cs=[],es=[],ab=b>=a?a/b:b/a,abnp1=1,root2z=Math.sqrt(2)*z,root2znm1=1,sgn=-1,ser=series(function(n){var i,seriesTerms;if(bgn*=bg,abnp1=-abnp1*ab,sgn=-sgn,0===n)es[0]=1,Ls[0]=Math.sqrt(Math.PI)/4*Math.exp(z*z)*erfc(z);else if(1===n)as[1]=2/3*(1-abnp1)*(b>=a?q:sgn*p),cs[1]=-.5*as[1],es[1]=-cs[1],Ls[1]=Math.pow(2,-1.5);else{for(root2znm1*=root2z,Ls[n]=Math.pow(2,-1.5)*root2znm1+(n-1)*Ls[n-2],as[n]=2/(n+2)*(1-abnp1)*(b>=a?q:sgn*p),r=(-n-1)/2,seriesTerms=function(j){return 0===j?0:((i-j)*r-j)*bs[j]*as[i-j]},bs=[1,r*as[1]],i=2;n>=i;i+=1)bs[i]=r*as[i]+1/i*series(seriesTerms,i);cs[n]=bs[n]/(n+1),es[n]=-series(function(k){return es[k]*cs[n-k]},n)}return es[n]*Ls[n]*bgn},100),Math.log(2/Math.sqrt(Math.PI))-bcorr(a,b)-z*z+Math.log(ser)}function bratioLog(a,b,x){var p,q,y,bint,bbar,lambda;return p=a/(a+b),q=b/(a+b),y=1-x,bint=Math.floor(b),bbar=b-bint,0===bbar&&(bbar+=1,bint-=1),lambda=a>b?(a+b)*y-b:a-(a+b)*x,0===a?{lower:0,upper:-1/0}:0===b?{lower:-1/0,upper:0}:Math.min(a,b)<=1?x>.5?tailFlip(bratioLog(b,a,y)):Math.max(a,b)>1?1>=b?fromLower(bpser(a,b,x)):x>=.3?fromUpper(bpser(b,a,y)):.1>x&&Math.pow(x*b,a)<=.7?fromLower(bpser(a,b,x)):fromUpper(b>15?bgrat(b,a,y):logspaceAdd(bup(b,a,y,x,20),bgrat(b+20,a,y))):a>=Math.min(.2,b)?fromLower(bpser(a,b,x)):Math.pow(x,a)<=.9?fromLower(bpser(a,b,x)):fromUpper(x>=.3?bpser(b,a,y):logspaceAdd(bup(b,a,y,x,20),bgrat(b+20,a,y))):x>p?tailFlip(bratioLog(b,a,y)):fromLower(40>b?.7>=b*x||lambda>650?bpser(a,b,x):.7>=x?logspaceAdd(bup(bbar,a,y,x,bint),bpser(a,bbar,x)):a>15?logspaceAdd(bup(bbar,a,y,x,bint),bgrat(a,bbar,x)):logspaceAdd(logspaceAdd(bup(bbar,a,y,x,bint),bup(a,bbar,x,y,20)),bgrat(a+20,bbar,x)):b>=a?100>=a?bfrac(a,b,x,y):.97*p>x?bfrac(a,b,x,y):basym(a,b,x,y):100>=b?bfrac(a,b,x,y):y>1.03*q?bfrac(a,b,x,y):basym(a,b,x,y))}function bratio(a,b,x,lowerTail,logp){var resLog;return resLog=bratioLog(a,b,x),lowerTail=lowerTail!==!1,logp=logp===!0,resLog=lowerTail?resLog.lower:resLog.upper,logp?resLog:Math.exp(resLog)}var C,stirlerr,log1p,gam1,algdiv,series,contFrac,logspaceAdd,phi,lbeta,erfc,gratR;return C=require("../constants"),stirlerr=require("./stirlerr").stirlerr,log1p=require("./log1p").log1p,gam1=require("./gam1").gam1,phi=require("./phi").phi,erfc=require("./erf").erfc,lbeta=require("./lbeta").lbeta,series=require("../utils").series,contFrac=require("../utils").contFrac,logspaceAdd=require("../utils").logspaceAdd,gratR=require("./gratio").gratR,algdiv=function(){var ds;return ds=[.0833333333333333,-.00277777777760991,.00079365066682539,-.00059520293135187,.000837308034031215,-.00125322962780713],function(a,b){var w,p,q,s;return p=a/(a+b),q=b/(a+b),s=1,w=p/b*series(function(i){return 0===i?ds[0]:(s+=Math.pow(q,2*i-1)+Math.pow(q,2*i),ds[i]*s/Math.pow(b,2*i))},6),w-(a+b-.5)*Math.log(1+a/b)-a*(Math.log(b)-1)}}(),{bratio:bratio}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../constants":16,"../utils":32,"./erf":5,"./gam1":7,"./gratio":8,"./lbeta":9,"./log1p":11,"./phi":13,"./stirlerr":14}],5:[function(require,module){!function(define){"use strict";define(function(require){var erf,erfc,R4small,R8med,R5large,Rational,piSqrtInv;return piSqrtInv=1/Math.sqrt(Math.PI),Rational=require("../rational"),R4small=Rational.new([.18577770618460315,3.1611237438705655,113.86415415105016,377.485237685302,3209.3775891384694],[1,23.601290952344122,244.02463793444417,1282.6165260773723,2844.236833439171]),R8med=Rational.new([2.1531153547440383e-8,.5641884969886701,8.883149794388377,66.11919063714163,298.6351381974001,881.952221241769,1712.0476126340707,2051.0783778260716,1230.3393547979972],[1,15.744926110709835,117.6939508913125,537.1811018620099,1621.3895745666903,3290.7992357334597,4362.619090143247,3439.3676741437216,1230.3393548037495]),R5large=Rational.new([-.016315387137302097,-.30532663496123236,-.36034489994980445,-.12578172611122926,-.016083785148742275,-.0006587491615298378],[1,2.568520192289822,1.8729528499234604,.5279051029514285,.06051834131244132,.0023352049762686918]),erf=function erf(x){return-.5>x?-erf(-x):.5>x?x*R4small.evalAt(x*x):1-erfc(x)},erfc=function erfc(x){var x2inv;return-.5>x?2-erfc(-x):.5>x?1-erf(x):4>=x?Math.exp(-x*x)*R8med.evalAt(x):(x2inv=1/(x*x),Math.exp(-x*x)/x*(piSqrtInv+x2inv*R5large.evalAt(x2inv)))},{erf:erf,erfc:erfc}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../rational":27}],6:[function(require,module){!function(define){"use strict";define(function(require){var Rational,expm1;return Rational=require("../rational"),expm1=function(){var R=Rational.new([.0238082361044469,9.14041914819518e-10,1],[.000595130811860248,-.0119041179760821,.107141568980644,-.499999999085958,1]);return function(x){return-.15>x?Math.exp(x)-1:x>.15?Math.exp(x)*(1-1/Math.exp(x)):x*R.evalAt(x)}}(),{expm1:expm1}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../rational":27}],7:[function(require,module){!function(define){"use strict";define(function(require){function gam1(x){return-1>=x?0/0:-.5>x||x>1.5?1/gamma(x+1)-1:0>=x?x*(1+w.evalAt(x)):.5>=x?x*w1.evalAt(x):1>=x?(x-1)/x*w.evalAt(x-1):(x-1)/x*(w1.evalAt(x-1)-1)}var w,w1,gamma,Rational;return gamma=require("./lgamma").gamma,Rational=require("../rational"),w=Rational.new([-.000132674909766242,.000266505979058923,.00223047661158249,-.0118290993445146,.000930357293360349,.118378989872749,-.244757765222226,-.771330383816272,-.422784335098468],[.0559398236957378,.273076135303597,1]),w1=Rational.new([.000589597428611429,-.00514889771323592,.0076696818164949,.0597275330452234,-.230975380857675,-.409078193005776,.577215664901533],[.00423244297896961,.0261132021441447,.158451672430138,.427569613095214,1]),{gam1:gam1}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../rational":27,"./lgamma":10}],8:[function(require,module){!function(define){"use strict";define(function(require){function e(y){return.5-(1-y/3)*Math.sqrt(y/Math.PI)}function j(a,x){var v;return v=-x,-a*series(function(i){return 0===i?0:1===i?-x/(a+1):(v=v*-x/i,v/(a+i))})}function gratio(a){return 0>=a?function(){return 0/0}:.5===a?function(x){return erf(Math.sqrt(x))}:1>a?smallP(a):BIG>a?mediumP(a):bigP(a)}function gratioc(a){return 0>=a?function(){return 0/0}:.5===a?function(x){return erfc(Math.sqrt(x))}:1>a?smallQ(a):BIG>a?mediumQ(a):bigQ(a)}function findx0SmallA(a,p,q){var B,u,temp;return B=q*gamma(a),B>.6||B>=.45&&a>=.3?(u=B*q>1e-8?Math.pow(p*gamma(a+1),1/a):Math.exp(-q/a-eulerGamma),u/(1-u/(a+1))):.3>a&&B>=.35&&.6>=B?(temp=Math.exp(-eulerGamma-B),u=temp*Math.exp(temp),temp*Math.exp(u)):(temp=-Math.log(B),u=temp-(1-a)*Math.log(temp),B>=.15?temp-(1-a)*Math.log(u)-Math.log(1+(1-a)/(1+u)):B>.01?temp-(1-a)*Math.log(u)-Math.log((u*u+2*(3-a)*u+(2-a)*(3-a))/(u*u+(5-a)*u+2)):findx0TinyB(a,temp))}function findx0TinyB(a,y){var c1;return c1=(a-1)*Math.log(y),y+Polynomial.new([(a-1)*Polynomial.new([-.25,(11*a-17)/6,-3*a*a+13*a-13,(2*a*a*a-25*a*a+72*a-61)/2,(25*a*a*a-195*a*a+477*a-379)/12]).evalAt(c1),(a-1)*Polynomial.new([1/3,(3*a-5)/2,a*a-6*a+7,(11*a*a-46*a+47)/6]).evalAt(c1),(a-1)*(-.5*c1*c1+(a-2)*c1+(3*a-5)/2),(a-1)*(1+c1),c1]).evalAt(1/y)}function findx0BigA(a,p,q){function snTerm(x){return function(n,v){return 0===n?1:v*x/(a+n)}}function f(x,n){return Math.exp((logpg+x-Math.log(series(snTerm(x),n+1)))/a)}var w,s,D,B,u,z,zbar,logpg;return logpg=Math.log(p*gamma(a+1)),B=q*gamma(a),D=Math.max(2,a*(a-1)),s=funS(p,q),w=a+s*Math.sqrt(a)+(s*s-1)/3+(s*s*s-7*s)/(36*Math.sqrt(a))-(3*s*s*s*s+7*s*s-16)/(810*a)+(9*s*s*s*s*s+256*s*s*s-433*s)/(38880*a*Math.sqrt(a)),a>=500&&Math.abs(1-w/a)<1e-6?w:p>.5?3*a>w?w:B<Math.pow(10,-D)?findx0TinyB(a,-Math.log(B)):(u=-Math.log(B)+(a-1)*Math.log(w)-Math.log(1+(1-a)/(1+w)),-Math.log(B)+(a-1)*Math.log(u)-Math.log(1+(1-a)/(1+u))):(z=w>.15*(a+1)?w:f(f(f(f(w,1),3),3),4),.01*(a+1)>=z||z>.7*(a+1)?z:function(){var N,term;N=0,term=1;do N+=1,term=snTerm(z)(N,term);while(term>1e-4);return zbar=f(z,N+1),zbar*(1-(a*Math.log(zbar)-zbar-logpg+Math.log(series(snTerm(z),N+1)))/(a-zbar))}())}function step(x,a,p,q){var temp,w;return temp=.5>=p?gratio(a)(x)-p:q-gratioc(a)(x),temp/=r(a,x),w=(a-1-x)/2,Math.max(Math.abs(temp),Math.abs(w*temp))<=.1?x*(1-(temp+w*temp*temp)):x*(1-temp)}function gaminv(a){return 0>=a?function(){return 0/0}:function(p,lower){var q,x;return lower===!1?(q=p,p=1-q):q=1-p,0===p?0:1===p?1/0:0>p||p>1?0/0:1===a?-Math.log(q):(x=1>a?findx0SmallA(a,p,q):findx0BigA(a,p,q),repeat(x,function(){return x=step(x,a,p,q)}))}}function gratR(a,x,logr){var ser,z,l,h,rinv;return rinv=Math.exp(-logr),0===x?rinv:0===a?0:.5===a?.25>x?(1-erf(Math.sqrt(x)))*rinv:Math.exp(x)*erfc(Math.sqrt(x))/Math.sqrt(x)*Math.sqrt(Math.PI):(z=a*Math.log(x),l=expm1(z),h=gam1(a),1.1>x?(ser=a*x*series(function(c,v){return function(i){return c+=1,i>0&&(v=v*-x/(i+1)),v/c}}(a,1)),x>=.25&&x/2.59>a||z>-.13394?Math.max(0,((Math.exp(z)*ser-l)*(1+h)-h)*rinv):(1-Math.exp(z)*(1+h)*(1-ser))*rinv):cf(a,x))}var phi,gam1,repeat,series,contFrac,cf,BIG,x0,e0,t,logroot,r,Rational,Polynomial,gamma,lgamma,erf,erfc,expm1,smallP,smallQ,mediumP,mediumQ,bigP,bigQ,eulerGamma,funS;return Rational=require("../rational"),Polynomial=require("../polynomial"),gamma=require("./lgamma").gamma,lgamma=require("./lgamma").lgamma,erf=require("./erf").erf,erfc=require("./erf").erfc,repeat=require("../utils").repeat,series=require("../utils").series,contFrac=require("../utils").contFrac,expm1=require("./expm1").expm1,eulerGamma=require("../constants").eulerGamma,gam1=require("./gam1").gam1,phi=require("./phi").phi,logroot=Math.log(Math.sqrt(.765)),BIG=20,x0=31,e0=25e-5,t=function(){var cs;return cs=[new Polynomial([-4.382036018453353e-9,1.0261809784240309e-8,6.707853543401498e-9,-1.7665952736826078e-7,8.296711340953087e-7,-185406221071516e-20,-2185448510679992e-21,3919263178522438e-20,-.0001787551440329218,.0003527336860670194,.0011574074074074073,-.014814814814814815,.08333333333333333,-.3333333333333333]),new Polynomial([1.1951628599778148e-8,-5.752545603517705e-8,1.378633446915721e-7,4.647127802807434e-9,-16120900894563446e-22,764916091608111e-20,-18098550334489977e-21,-4.018775720164609e-7,.00020576131687242798,-.0009902263374485596,.0026455026455026454,-.003472222222222222,-.001851851851851852]),new Polynomial([1.4280614206064242e-7,-6.298992138380055e-7,13721957309062934e-22,3.423578734096138e-8,-12760635188618728e-21,52923448829120125e-21,-.0001073665322636516,20093878600823047e-22,.0007716049382716049,-.0026813271604938273,.004133597883597883]),new Polynomial([14230900732435883e-22,-56749528269915965e-22,11082654115347302e-21,-2.396505113867297e-7,-7561801671883977e-20,.00026772063206283885,-.0004691894943952557,.00022947209362139917,.0006494341563786008]),new Polynomial([11375726970678419e-21,-3968365047179435e-20,6641498215465122e-20,-14638452578843418e-22,-.0002990724803031902,.0007840392217200666,-.0008618882909167117]),new Polynomial([6797780477937208e-20,-.00019932570516188847,.0002772753244959392,-6972813758365857e-20,-.00033679855336635813]),new Polynomial([.0002708782096718045,-.0005921664373536939,.0005313079364639922])],function(a,lambda){var z,atomk;return atomk=a,z=(lambda>=1?1:-1)*Math.sqrt(2*phi(lambda)),cs.reduce(function(sum,poly){return atomk/=a,sum+poly.evalAt(z)*atomk},0)}}(),r=function(){function delta(a){return lgamma(a)-(a-.5)*Math.log(a)+a-.5*Math.log(2*Math.PI)}return function(a,x){return 20>=a?Math.exp(-x)*Math.pow(x,a)/gamma(a):Math.sqrt(a/(2*Math.PI))*Math.exp(-a*phi(x/a)-delta(a))}}(),cf=function(a,x){function as(i){return 0===i?0:i%2===1?x:1}function bs(i){return i%2===1?1===i?1:(i-1)/2:i/2-a}return contFrac(as,bs)},smallP=function(a){var gamm;return gamm=gamma(a+1),function(x){var alpha;return 1.1>x?(alpha=.5>x?logroot/Math.log(x):x/2.59,a>=alpha?Math.pow(x,a)*(1-j(a,x))/gamm:1-smallQ(a)(x)):1-smallQ(a)(x)}},smallQ=function(a){var gamm,ha;return gamm=gamma(a+1),ha=gam1(a),function(x){var alpha;return 1.1>x?(alpha=.5>x?logroot/Math.log(x):x/2.59,a>=alpha?1-smallP(a)(x):(Math.pow(x,a)*j(a,x)-expm1(a*Math.log(x)))/gamm-ha):r(a,x)*cf(a,x)}},mediumP=function(a){return function(x){return(a>x||x>=x0||a!==Math.round(2*a))&&x<=Math.max(a,Math.LN10)?r(a,x)/a*series(function(n,v){return 0===n?1:v*x/(a+n)}):1-mediumQ(a)(x)}},mediumQ=function(a){return function(x){return x>=a&&x0>x&&2*a===Math.round(2*a)?a===Math.floor(a)?Math.exp(-x)*series(function(i,v){return 0===i?1:v*x/i},a):erfc(Math.sqrt(x))+Math.exp(-x)/Math.sqrt(Math.PI*x)*series(function(i,v){return 0===i?0:1===i?x/.5:v*x/(i-.5)},Math.round(a+.5)):x<=Math.max(a,Math.LN10)?1-mediumP(a)(x):x0>x?r(a,x)*cf(a,x):r(a,x)/x*series(function(n,v){return 0===n?1:v*(a-n)/x})}},bigP=function(a){return function(x){var lambda,sigma,y;return lambda=x/a,sigma=Math.abs(1-lambda),y=a*phi(lambda),sigma<=e0/Math.sqrt(a)?lambda>1?1-bigQ(a)(x):e(y)-(1-y)/Math.sqrt(2*Math.PI*a)*t(a,lambda):.4>=sigma?lambda>1?1-bigQ(a)(x):.5*erfc(Math.sqrt(y))-Math.exp(-y)/Math.sqrt(2*Math.PI*a)*t(a,lambda):x<=Math.max(a,Math.LN10)?r(a,x)/a*series(function(n,v){return 0===n?1:v*x/(a+n)}):1-bigQ(a)(x)}},bigQ=function(a){return function(x){var lambda,sigma,y;return lambda=x/a,sigma=Math.abs(1-lambda),y=a*phi(lambda),sigma<=e0/Math.sqrt(a)?1>=lambda?1-bigP(a)(x):e(y)+(1-y)/Math.sqrt(2*Math.PI*a)*t(a,lambda):.4>=sigma?1>=lambda?1-bigP(a)(x):.5*erfc(Math.sqrt(y))+Math.exp(-y)/Math.sqrt(2*Math.PI*a)*t(a,lambda):x<=Math.max(a,Math.LN10)?1-bigP(a)(x):x0>x?r(a,x)*cf(a,x):r(a,x)/x*series(function(n,v){return 0===n?1:v*(a-n)/x})}},funS=function(){var ratFun=Rational.new([.213623493715853,4.28342155967104,11.6616720288968,3.31125922108741],[.036117081018842,1.27364489782223,6.40691597760039,6.61053765625462,1]);return function(p,q){var temp;return temp=Math.sqrt(-2*Math.log(.5>p?p:q)),(.5>p?-1:1)*(temp-ratFun.evalAt(temp))}}(),{gratio:gratio,gratioc:gratioc,gaminv:gaminv,gratR:gratR}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../constants":16,"../polynomial":26,"../rational":27,"../utils":32,"./erf":5,"./expm1":6,"./gam1":7,"./lgamma":10,"./phi":13}],9:[function(require,module){!function(define){"use strict";define(function(require){function lbeta(a,b){return a>b?lbeta(b,a):0>a?0/0:0===a?1/0:1/0===b?-1/0:a>10?-.5*Math.log(b)+Math.log(sqrt2pi)+(stirlerr(a)+stirlerr(b)-stirlerr(a+b))+(a-.5)*Math.log(a/(a+b))+b*log1p(-a/(a+b)):b>=10?lgamma(a)+(stirlerr(b)-stirlerr(a+b))+a-a*Math.log(a+b)+(b-.5)*log1p(-a/(a+b)):lgamma(a)+(lgamma(b)-lgamma(a+b))}function beta(a,b){return Math.exp(lbeta(a,b))}var stirlerr,sqrt2pi,log1p,lgamma;return stirlerr=require("./stirlerr").stirlerr,log1p=require("./log1p").log1p,lgamma=require("./lgamma").lgamma,sqrt2pi=require("../constants").sqrt2pi,{lbeta:lbeta,beta:beta}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../constants":16,"./lgamma":10,"./log1p":11,"./stirlerr":14}],10:[function(require,module){!function(define){"use strict";define(function(require){function pade22(n1,n2,d1,d2,c,corr){return function(eps){var eps5,pade;return pade=c*(eps+n1)*(eps+n2)/((eps+d1)*(eps+d2)),eps5=eps*eps*eps*eps*eps,eps*(pade+eps5*corr.evalAt(eps))}}function gamma(x){return Math.exp(lgamma(x))}var C,lgamma,lgammaLanczos,lgammaNear1or2,Polynomial;return Polynomial=require("../polynomial"),C=require("../constants"),lgammaLanczos=function(){var cs=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];return function(z){var t,i,ser;for(t=z+7.5,t-=(z+.5)*Math.log(t),ser=cs[0],i=1;i<cs.length;i+=1)ser+=cs[i]/(z+i);return-t+Math.log(C.sqrt2pi*ser/z)}}(),lgammaNear1or2=function(){var p1,p2;return p1=pade22(-1.001741928234951,1.736483920992288,1.2433006018858752,5.045627410027401,2.081626518866269,new Polynomial([.03141928755021455,-.0259402739872502,.01931961413960498,-.01192457083645441,.004785324257581753])),p2=pade22(1.0008958347866692,4.209376735287755,2.618851904903217,10.857665599009835,2.853379987657819,new Polynomial([40722092786795e-18,-693271800931282e-19,.0001067287169183665,-.0001365435269792533,.0001139406357036744])),function(x){return 1.6>=x?p1(x-1):p2(x-2)}}(),lgamma=function(x){return 0>=x?0/0:1===x||2===x?0:Math.abs(x-1)<=.01||Math.abs(x-2)<=.01?lgammaNear1or2(x):lgammaLanczos(x)},{lgamma:lgamma,gamma:gamma}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../constants":16,"../polynomial":26}],11:[function(require,module){!function(define){"use strict";define(function(require){var Rational,log1p;return Rational=require("../rational"),log1p=function(){var R=Rational.new([-.0178874546012214,.405303492862024,-1.29418923021993,1],[-.0845104217945565,.747811014037616,-1.62752256355323,1]);return function(x){var t;return Math.abs(x)>.375?Math.log(1+x):(t=x/(x+2),2*t*R.evalAt(t*t))}}(),{log1p:log1p}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../rational":27}],12:[function(require,module){!function(define){"use strict";define(function(require){function lpoisson(lambda){return 0===lambda?function(x){return 0===x?0:-1/0}:function(x){return 0===x?-lambda:-stirlerr(x)-bd0(x,lambda)-.5*Math.log(C.twopi*x)}}var C,bd0,stirlerr;return C=require("../constants"),bd0=require("./bd0").bd0,stirlerr=require("./stirlerr").stirlerr,{lpoisson:lpoisson}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../constants":16,"./bd0":3,"./stirlerr":14}],13:[function(require,module){!function(define){"use strict";define(function(require){function phi(x){var rat;return 0>x?0/0:0===x?1/0:.82>x||x>1.18?x-1-Math.log(x):(rat=(x-1)/(x+1),2*rat*rat*(1/(1-rat)-rat*phi1.evalAt(rat*rat)))}var phi1,Rational;return Rational=require("../rational"),phi1=new Rational([.00620886815375787,-.224696413112536,.333333333333333],[.354508718369557,-1.27408923933623,1]),{phi:phi}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../rational":27}],14:[function(require,module){!function(define){"use strict";define(function(require){function stirlerr(n){var nsq=n*n;return 15>=n?2*n===Math.floor(2*n)?precomputed[2*n]:lgamma(n+1)-(n+.5)*Math.log(n)+n-Math.log(C.sqrt2pi):n>500?(cs[0]-cs[1]/nsq)/n:n>80?(cs[0]-(cs[1]-cs[2]/nsq)/nsq)/n:n>35?(cs[0]-(cs[1]-(cs[2]-cs[3]/nsq)/nsq)/nsq)/n:(cs[0]-(cs[1]-(cs[2]-(cs[3]-cs[4]/nsq)/nsq)/nsq)/nsq)/n}var cs,precomputed,lgamma,C;return lgamma=require("./lgamma").lgamma,C=require("../constants"),cs=[1/12,1/360,1/1260,1/1680,1/1188],precomputed=[0/0,.15342640972002736,.08106146679532726,.05481412105191765,.0413406959554093,.03316287351993629,.02767792568499834,.023746163656297496,.020790672103765093,.018488450532673187,.016644691189821193,.015134973221917378,.013876128823070748,.012810465242920227,.01189670994589177,.011104559758206917,.010411265261972096,.009799416126158804,.009255462182712733,.008768700134139386,.00833056343336287,.00793411456431402,.007573675487951841,.007244554301320383,.00694284010720953,.006665247032707682,.006408994188004207,.006171712263039458,.0059513701127588475,.0057462165130101155,.005554733551962801],{stirlerr:stirlerr}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../constants":16,"./lgamma":10}],15:[function(require,module){!function(define){"use strict";define(function(require){var basicFunc,mixin;return mixin=require("./utils").mixin,basicFunc={},mixin(basicFunc,require("./basicFunc/log1p"),require("./basicFunc/expm1"),require("./basicFunc/erf"),require("./basicFunc/lbeta"),require("./basicFunc/lgamma"),require("./basicFunc/bd0"),require("./basicFunc/gam1"),require("./basicFunc/phi"),require("./basicFunc/stirlerr"),require("./basicFunc/bratio"),require("./basicFunc/gratio")),basicFunc})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"./basicFunc/bd0":3,"./basicFunc/bratio":4,"./basicFunc/erf":5,"./basicFunc/expm1":6,"./basicFunc/gam1":7,"./basicFunc/gratio":8,"./basicFunc/lbeta":9,"./basicFunc/lgamma":10,"./basicFunc/log1p":11,"./basicFunc/phi":13,"./basicFunc/stirlerr":14,"./utils":32}],16:[function(require,module){!function(define){"use strict";define(function(){var C;return C={twopi:2*Math.PI,sqrt2pi:Math.sqrt(2*Math.PI),log2pi:Math.log(2*Math.PI),epsilon:1e-15,eulerGamma:.5772156649015329},Object.freeze(C)})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{}],17:[function(require,module){!function(define){"use strict";define(function(require){var distributions,mixin;return mixin=require("./utils.js").mixin,distributions=mixin({},require("./distributions/finite"),require("./distributions/normal"),require("./distributions/gamma"),require("./distributions/poisson"),require("./distributions/t"),require("./distributions/uniform"),require("./distributions/beta"),require("./distributions/binom"))})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"./distributions/beta":18,"./distributions/binom":19,"./distributions/finite":20,"./distributions/gamma":21,"./distributions/normal":22,"./distributions/poisson":23,"./distributions/t":24,"./distributions/uniform":25,"./utils.js":32}],18:[function(require,module){!function(define){"use strict";define(function(require){function dbeta(a,b,logp){return logp=logp===!0,function(x){var lb,p,n;return 0>x||x>1?lb=-1/0:2>=a||2>=b?lb=(a-1)*Math.log(x)+(b-1)*log1p(-x)-lbeta(a,b):(p=x,x=a-1,n=a+b-2,lb=Math.log(a+b-1)+stirlerr(n)-stirlerr(x)-stirlerr(n-x)-bd0(x,n*p)-bd0(n-x,n*(1-p))+.5*Math.log(n/(C.twopi*x*(n-x)))),logp?lb:Math.exp(lb)}}function pbeta(a,b,lowerTail,logp){return logp=logp===!0,lowerTail=lowerTail!==!1,function(x){var lp;return 0>=a||0>=b?0/0:x>0&&1>x?bratio(a,b,x,lowerTail,logp):(lp=0>=x?0:1,lp=lowerTail?lp:1-lp,logp?Math.log(lp):lp)}}function qbeta(a,b,lowerTail,logp){var f;return lowerTail=lowerTail!==!1,logp=logp===!0,f=pbeta(a,b,lowerTail,logp),function(p){var l,u,incr,realLogP;if(0>=a||0>=b)return 0/0;if(!(logp||p>=0&&1>=p))return 0/0;if(realLogP=logp?p:Math.log(p),realLogP=lowerTail?realLogP:-realLogP,realLogP===-1/0)return 0;if(realLogP===+1/0)return 1;for(incr=.1,l=.1;f(l)>p===lowerTail;)if(l*=incr,1e-80>l)return new Error("qbeta failed to find left endpoint");for(u=1-incr;f(u)<p===lowerTail;)if(incr*=.1,u=1-incr,1e-80>incr)return new Error("qbeta failed to find right endpoint");return solve(function(x){return f(x)},p,l,u)}}var bratio,lbeta,solve,stirlerr,bd0,log1p,C;return C=require("../constants"),bd0=require("../basicFunc/bd0").bd0,stirlerr=require("../basicFunc/stirlerr").stirlerr,log1p=require("../basicFunc/log1p").log1p,lbeta=require("../basicFunc/lbeta").lbeta,bratio=require("../basicFunc/bratio").bratio,solve=require("../utils").binSearchSolve,{betadistr:function(a,b){return{d:function(x,logp){return dbeta(a,b,logp)(x)},p:function(q,lowerTail,logp){return pbeta(a,b,lowerTail,logp)(q)},q:function(p,lowerTail,logp){return qbeta(a,b,lowerTail,logp)(p)},r:function(n){return rbeta(a,b)(n)}}},dbeta:dbeta,pbeta:pbeta,qbeta:qbeta}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../basicFunc/bd0":3,"../basicFunc/bratio":4,"../basicFunc/lbeta":9,"../basicFunc/log1p":11,"../basicFunc/stirlerr":14,"../constants":16,"../utils":32}],19:[function(require,module){!function(define){"use strict";define(function(require){function dbinomLog(size,p){return 0===p?function(x){return 0===x?0:-1/0}:1===p?function(x){return x===size?0:-1/0}:function(x){return 0===x?size*Math.log(1-p):x===size?size*Math.log(p):0>x||x>size||Math.round(x)!==x?-1/0:stirlerr(size)-stirlerr(x)-stirlerr(size-x)-bd0(x,size*p)-bd0(size-x,size*(1-p))+.5*Math.log(size/(C.twopi*x*(size-x)))}}function dbinom(size,p,logp){var lbinom;return logp=logp===!0,lbinom=dbinomLog(size,p),function(x){return logp?lbinom(x):Math.exp(lbinom(x))}}function pbinom(size,p,lowerTail,logp){var goodParams;return logp=logp===!0,lowerTail=lowerTail!==!1,goodParams=size>=0&&1/0>size&&size===Math.floor(size)&&p>=0&&1>=p,goodParams?function(x){var res;return isNaN(x)?0/0:(res=lowerTail===0>x?-1/0:0,x=Math.floor(x),x>=0&&size>x&&(res=pbeta(x+1,size-x,!lowerTail,!0)(p)),logp?res:Math.exp(res))}:function(){return 0/0}}function qbinom(size,p,lowerTail,logp){var goodParams,mu,sigma,gamma;return logp=logp===!0,lowerTail=lowerTail!==!1,(goodParams=size>=0&&1/0>size&&size===Math.floor(size)&&p>=0&&1>=p)?0===p?pWrap(lowerTail,logp,function(prob){return 1===prob?size:0}):1===p?pWrap(lowerTail,logp,function(prob){return 0===prob?0:size}):(mu=size*p,sigma=Math.sqrt(mu*(1-p)),gamma=(1-2*p)/sigma,pWrap(!0,logp,function(prob){var z,ret;return z=qnorm(0,1,lowerTail)(prob),ret=Math.floor(mu+sigma*(z+gamma*(z*z-1)/6)+.5),ret>size&&(ret=size),1===prob?lowerTail?size:0:lowerTail?discInvCdf(0,size,ret,prob,pbinom(size,p)):-discInvCdf(-size,0,-ret,prob,function(x){return pbinom(size,p,lowerTail)(-x)})})):function(){return 0/0}}function rbinom(n,p){var mode;return mode={val:Math.floor(n*p)},mode.prob=dbinom(n,p)(mode.val),inverseCDF(function(){return mode},function(){return 0===this.val?!1:(this.prob*=this.val/(n-this.val+1)*((1-p)/p),this.val-=1,!0)},function(){return this.val===n?!1:(this.prob*=(n-this.val)/(this.val+1)*(p/(1-p)),this.val+=1,!0)})}var C,stirlerr,bd0,pbeta,qnorm,pWrap,discInvCdf,inverseCDF;return C=require("../constants"),stirlerr=require("../basicFunc/stirlerr").stirlerr,bd0=require("../basicFunc/bd0").bd0,pbeta=require("./beta").pbeta,qnorm=require("./normal").qnorm,pWrap=require("../utils").pWrap,discInvCdf=require("../utils").discInvCdf,inverseCDF=require("../rgen/inverseCDF"),{binom:function(size,p){return{d:function(x,logp){return dbinom(size,p,logp)(x)},p:function(q,lowerTail,logp){return pbinom(size,p,lowerTail,logp)(q)},q:function(prob,lowerTail,logp){return qbinom(size,p,lowerTail,logp)(prob)},r:function(n){return rbinom(size,p)(n)}}},dbinom:dbinom,pbinom:pbinom,qbinom:qbinom,rbinom:rbinom}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../basicFunc/bd0":3,"../basicFunc/stirlerr":14,"../constants":16,"../rgen/inverseCDF":30,"../utils":32,"./beta":18,"./normal":22}],20:[function(require,module){!function(define){"use strict";define(function(require){function finite(o){var sum,xs,ws,cumsLeft,cumsRight,i,finObj;for("function"==typeof o.f&&(o=populateObjectFromFunction(o)),xs=o.xs,ws=o.ws,sum=ws.reduce(function(v,acc){if(!(v>=0))throw new Error("finite: Negative weights");return v+acc},0),utils.relativelyCloseTo(sum,1)||(ws=ws.map(function(v){return v/sum})),sum=0,cumsLeft=ws.map(function(v){return sum+=v}),cumsRight=[],cumsRight[ws.length-1]=0,i=ws.length-2;i>=0;i-=1)cumsRight[i]=cumsRight[i+1]+ws[i+1];return finObj={d:function(x,logp){var ind,ret;return logp=logp===!0,x<xs[0]||x>xs[xs.length-1]?ret=0:(ind=binSearch(xs,function(y){return x>=y}),ret=xs[ind]===x?ws[ind]:0),logp?Math.log(ret):ret},p:function(q,lowerTail,logp){var ind,ret;return logp=logp===!0,lowerTail=lowerTail!==!1,isNaN(q)?0/0:(q<xs[0]?ret=lowerTail?0:1:q>=xs[xs.length-1]?ret=lowerTail?1:0:(ind=binSearch(xs,function(y){return q>=y}),ret=lowerTail?cumsLeft[ind]:cumsRight[ind]),ret=Math.min(ret,1),logp?Math.log(ret):ret)},q:function(p,lowerTail,logp){return logp=logp===!0,lowerTail=lowerTail!==!1,logp&&(p=Math.exp(p)),isNaN(p)?0/0:0>p||p>1?0/0:1===p?lowerTail?xs[xs.length-1]:xs[0]:0===p?lowerTail?xs[0]:xs[xs.length-1]:lowerTail?xs[binSearch2(cumsLeft,function(y){return utils.relativelyCloseTo(y,p,1e-14)||y>p})]:xs[binSearch2(cumsRight,function(y){return utils.relativelyCloseTo(y,p,1e-14)||p>=y})]},r:function(){return finObj.q(rgen.random())}}}function binSearch(xs,pred){var a,b,mid;for(a=0,b=xs.length;b-a>1;)mid=Math.floor((a+b)/2),pred(xs[mid])?a=mid:b=mid;return a}function binSearch2(xs,pred){var a,b,mid;for(a=-1,b=xs.length-1;b-a>1;)mid=Math.floor((a+b)/2),pred(xs[mid])?b=mid:a=mid;return b}function populateObjectFromFunction(o){var i,obj;
if(obj={xs:[],ws:[]},!(o.min<=o.max))throw new Error("finite: Invalid range specification, expected min <= max");for(i=o.min;i<=o.max;i+=1)obj.xs.push(i),obj.ws.push(o.f(i));return obj}var utils,rgen;return utils=require("../utils"),rgen=require("../rgen/rgen"),{finite:finite,dfinite:function(o,logp){var distr=finite(o);return function(x){return distr.d(x,logp)}},pfinite:function(o,lowerTail,logp){var distr=finite(o);return function(q){return distr.p(q,lowerTail,logp)}},qfinite:function(o,lowerTail,logp){var distr=finite(o);return function(p){return distr.q(p,lowerTail,logp)}},rfinite:function(o){return finite(o).r}}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../rgen/rgen":31,"../utils":32}],21:[function(require,module){!function(define){"use strict";define(function(require){function dgammaLog(a,s){return 1>a?function(x){return 0===x?1/0:Math.log(a/x)+lpoisson(x/s)(a)}:1===a?function(x){return-x/s-Math.log(s)}:function(x){return 0===x?-1/0:-Math.log(s)+lpoisson(x/s)(a-1)}}function dgamma(a,s,logp){return logp=logp===!0,function(x){return logp?dgammaLog(a,s)(x):Math.exp(dgammaLog(a,s)(x))}}function pgamma(a,s,lowerTail,logp){var f;return 0>=s||0>=a?function(){return 0/0}:(logp=logp===!0,lowerTail=lowerTail!==!1,f=lowerTail?gratio.gratio(a):gratio.gratioc(a),function(x){var p;return p=x>0?f(x/s):lowerTail?0:1,logp?Math.log(p):p})}function qgamma(a,s,lowerTail,logp){var gaminv;return 0>=s||0>=a?function(){return 0/0}:(logp=logp===!0,lowerTail=lowerTail!==!1,gaminv=gratio.gaminv(a),function(p){return p=logp?Math.exp(p):p,p>=0&&1>=p?s*gaminv(p,lowerTail):0/0})}function rgamma(a,s){return 1>a?gammaBest(a,s):a>1?gammaCheng(a,s):exponential(1/s)}function gammaBest(a,s){var t,b;return t=.07+.75*Math.sqrt(1-a),b=1+Math.exp(-t)*a/t,function(){for(var x,y,u1,u2,v;;)if(u1=rgen.random(),u2=rgen.random(),v=b*u1,1>=v){if(x=t*Math.pow(v,1/a),(2-x)/(2+x)>=u2||u2<=Math.exp(-x))return x*s}else if(x=-Math.log(t*(b-v)/a),y=x/t,1>=u2*(a+y*(1-a))||u2<=Math.pow(y,a-1))return x*s}}function gammaCheng(a,s){var c1,c2,c3,c4;return c1=a-1,c2=(a-1/(6*a))/c1,c3=2/c1,c4=c3+2,function(){for(var u1,u2,w;;){if(u1=rgen.random(),u2=rgen.random(),w=c2*u2/u1,c4>=c3*u1+w+1/w)return c1*w*s;if(c3*Math.log(u1)-Math.log(w)+w<1)return c1*w*s}}}var lpoisson,gratio,exponential,rgen;return lpoisson=require("../basicFunc/lpoisson").lpoisson,gratio=require("../basicFunc/gratio"),exponential=require("../rgen/exponential"),rgen=require("../rgen/rgen"),{gammadistr:function(a,s){return{d:function(x,logp){return dgamma(a,s,logp)(x)},p:function(q,lowerTail,logp){return pgamma(a,s,lowerTail,logp)(q)},q:function(p,lowerTail,logp){return qgamma(a,s,lowerTail,logp)(p)},r:function(n){return rgamma(a,s)(n)}}},dgamma:dgamma,pgamma:pgamma,qgamma:qgamma,rgamma:rgamma}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../basicFunc/gratio":8,"../basicFunc/lpoisson":12,"../rgen/exponential":29,"../rgen/rgen":31}],22:[function(require,module){!function(define){"use strict";define(function(require){function dnorm(mu,sigma,logp){var c;return logp=logp===!0,c=Math.log(twopi),function(x){var z,p;return z=(x-mu)/sigma,p=-.5*(c+z*z),logp?p:Math.exp(p)}}function rnorm(mu,sigma){return function(){var v1,v2,rsq;do v1=2*rgen.random()-1,v2=2*rgen.random()-1,rsq=v1*v1+v2*v2;while(rsq>=1);return mu+sigma*v1*Math.sqrt(-2*Math.log(rsq)/rsq)}}var C,twopi,sqrt2pi,Rational,pnorm,qnorm,pWrap,rgen;return C=require("../constants"),twopi=C.twopi,sqrt2pi=C.sqrt2pi,Rational=require("../rational"),pWrap=require("../utils").pWrap,rgen=require("../rgen/rgen"),pnorm=function(){function addExpTerm(x,rational){return Math.exp(-.5*x*x)*rational}var small,medium,large;return small=Rational.new([.06568233791820745,2.2352520354606837,161.02823106855587,1067.6894854603709,18154.98125334356],[1,47.202581904688245,976.0985517377767,10260.932208618979,45507.78933502673]),medium=Rational.new([1.0765576773720192e-8,.39894151208813466,8.883149794388377,93.50665613217785,597.2702763948002,2494.5375852903726,6848.190450536283,11602.65143764735,9842.714838383978],[1,22.266688044328117,235.387901782625,1519.3775994075547,6485.558298266761,18615.571640885097,34900.95272114598,38912.00328609327,19685.429676859992]),large=Rational.new([.023073441764940174,.215898534057957,.12740116116024736,.022235277870649807,.0014216191932278934,29112874951168793e-21],[1,1.284260096144911,.4682382124808651,.06598813786892856,.0037823963320275824,7297515550839662e-20]),function(mu,sigma,lowerTail,logp){return lowerTail=lowerTail!==!1,logp=logp===!0,function(x){var z,absz,oneOverzsq,r,ret,lower;return lower=lowerTail,z=(x-mu)/sigma,z>5&&!lower&&(z=-z,lower=!0),absz=Math.abs(z),.66291>absz?ret=.5+z*small.evalAt(z*z):5.656854>absz?(r=addExpTerm(z,medium.evalAt(absz)),ret=z>0?1-r:r):z>8.572?ret=1:-37.519>z?ret=0:(oneOverzsq=1/(z*z),r=oneOverzsq*large.evalAt(oneOverzsq),r=addExpTerm(z,(1/sqrt2pi-r)/absz),ret=z>0?1-r:r),lower||(ret=1-ret),logp&&(ret=Math.log(ret)),ret}}}(),qnorm=function(){var small,medium,large;return small=Rational.new([2509.0809287301227,33430.57558358813,67265.7709270087,45921.95393154987,13731.69376550946,1971.5909503065513,133.14166789178438,3.3871328727963665],[5226.495278852854,28729.085735721943,39307.89580009271,21213.794301586597,5394.196021424751,687.1870074920579,42.31333070160091,1]),medium=Rational.new([.0007745450142783414,.022723844989269184,.2417807251774506,1.2704582524523684,3.6478483247632045,5.769497221460691,4.630337846156546,1.4234371107496835],[1.0507500716444169e-9,.0005475938084995345,.015198666563616457,.14810397642748008,.6897673349851,1.6763848301838038,2.053191626637759,1]),large=Rational.new([2.0103343992922881e-7,27115555687434876e-21,.0012426609473880784,.026532189526576124,.29656057182850487,1.7848265399172913,5.463784911164114,6.657904643501103],[2.0442631033899397e-15,1.421511758316446e-7,18463183175100548e-21,.0007868691311456133,.014875361290850615,.1369298809227358,.599832206555888,1]),function(mu,sigma,lowerTail,logp){return lowerTail=lowerTail!==!1,logp=logp===!0,pWrap(lowerTail,logp,function(p){var dp,minp,r;return dp=p-.5,minp=.5>p?p:1-p,1===p?1/0:0===p?-1/0:(Math.abs(dp)<=.425?r=dp*small.evalAt(.180625-dp*dp):(r=Math.sqrt(-Math.log(minp)),r=5>=r?medium.evalAt(r-1.6):large.evalAt(r-5),r=.5>p?-r:r),mu+sigma*r)})}}(),{normal:function(mu,sigma){return{d:function(x,logp){return dnorm(mu,sigma,logp)(x)},p:function(q,lowerTail,logp){return pnorm(mu,sigma,lowerTail,logp)(q)},q:function(p,lowerTail,logp){return qnorm(mu,sigma,lowerTail,logp)(p)},r:function(n){return rnorm(mu,sigma)(n)}}},dnorm:dnorm,pnorm:pnorm,qnorm:qnorm,rnorm:rnorm}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../constants":16,"../rational":27,"../rgen/rgen":31,"../utils":32}],23:[function(require,module){!function(define){"use strict";define(function(require){function dpois(lambda,logp){return logp=logp===!0,function(x){return logp?lpoisson(lambda)(x):Math.exp(lpoisson(lambda)(x))}}function ppois(lambda,lowerTail,logp){return lowerTail=lowerTail!==!1,logp=logp===!0,lambda>=0?function(x){var ret;return x>=0&&lambda>0?pgamma(Math.floor(x+1e-10)+1,1,!lowerTail,logp)(lambda):(ret=lowerTail?1:0,0>x&&(ret=lowerTail?0:1),logp?Math.log(ret):ret)}:function(){return 0/0}}function qpois(lambda,lowerTail,logp){var goodParams,mu,sigma,gamma;return logp=logp===!0,lowerTail=lowerTail!==!1,(goodParams=lambda>=0&&1/0>lambda)?0===lambda?pWrap(lowerTail,logp,function(){return 0}):(mu=lambda,sigma=Math.sqrt(lambda),gamma=1/sigma,pWrap(!0,logp,function(prob){var z,ret;return z=qnorm(0,1,lowerTail)(prob),-10>z&&(z=-10),z>10&&(z=10),ret=Math.floor(mu+sigma*(z+gamma*(z*z-1)/6)+.5),1===prob?lowerTail?1/0:0:lowerTail?discInvCdf(0,1e10,ret,prob,ppois(lambda)):-discInvCdf(-1e10,0,-ret,prob,function(x){return ppois(lambda,lowerTail)(-x)})})):function(){return 0/0}}function rpois(lambda){var mode;return mode={val:Math.floor(lambda)},mode.prob=Math.exp(-lambda+mode.val*Math.log(lambda)-lgamma(mode.val+1)),inverseCDF(function(){return mode},function(){return 0===this.val?!1:(this.prob*=this.val/lambda,this.val-=1,!0)},function(){return this.val+=1,this.prob*=lambda/this.val,!0})}var lpoisson,lgamma,pgamma,pWrap,qnorm,discInvCdf,inverseCDF;return lpoisson=require("../basicFunc/lpoisson").lpoisson,lgamma=require("../basicFunc/lgamma").lgamma,pgamma=require("./gamma").pgamma,pWrap=require("../utils").pWrap,discInvCdf=require("../utils").discInvCdf,qnorm=require("./normal").qnorm,inverseCDF=require("../rgen/inverseCDF"),{pois:function(lambda){return{d:function(x,logp){return dpois(lambda,logp)(x)},p:function(q,lowerTail,logp){return ppois(lambda,lowerTail,logp)(q)},q:function(p,lowerTail,logp){return qpois(lambda,lowerTail,logp)(p)},r:function(n){return rpois(lambda)(n)}}},dpois:dpois,ppois:ppois,qpois:qpois,rpois:rpois}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../basicFunc/lgamma":10,"../basicFunc/lpoisson":12,"../rgen/inverseCDF":30,"../utils":32,"./gamma":21,"./normal":22}],24:[function(require,module){!function(define){"use strict";define(function(require){function dtlog(n){var t;return t=-bd0(n/2,(n+1)/2)+stirlerr((n+1)/2)-stirlerr(n/2),function(x){var x2n,logx2n,u;return x2n=x*x/n,logx2n=Math.log(1+x2n)/2,u=x2n>.2?n*logx2n:x*x/2-bd0(n/2,(n+x*x)/2),t-u-(logx2n+Math.log(sqrt2pi))}}function dt(n,logp){logp=logp===!0;var dtl;return dtl=dtlog(n),function(x){return logp?dtl(x):Math.exp(dtl(x))}}function ptlog(df,lowerTail){return function(x){var val;return val=df>x*x?bratio(.5,df/2,x*x/(df+x*x),!1,!0):bratio(df/2,.5,1/(1+x/df*x),!0,!0),0>=x&&(lowerTail=!lowerTail),lowerTail?log1p(-.5*Math.exp(val)):val-Math.log(2)}}function pt(df,lowerTail,logp){var ptl;return lowerTail=lowerTail!==!1,logp=logp===!0,ptl=ptlog(df,lowerTail),function(x){return logp?ptl(x):Math.exp(ptl(x))}}function qt(df,lowerTail,logp){return lowerTail=lowerTail!==!1,logp=logp===!0,function(p){return solve(function(x){return pt(df,lowerTail,logp)(x)},p)}}function rt(df){return function(){var u1,u2,rsq;do u1=2*rgen.random()-1,u2=2*rgen.random()-1,rsq=u1*u1+u2*u2;while(rsq>=1);return u1*Math.sqrt(df*(Math.pow(rsq,-2/df)-1)/rsq)}}var C,bd0,stirlerr,sqrt2pi,bratio,log1p,solve,rgen;return C=require("../constants"),bd0=require("../basicFunc/bd0").bd0,stirlerr=require("../basicFunc/stirlerr").stirlerr,sqrt2pi=C.sqrt2pi,bratio=require("../basicFunc/bratio").bratio,log1p=require("../basicFunc/log1p").log1p,solve=require("../utils").binSearchSolve,rgen=require("../rgen/rgen"),{tdistr:function(df){return{d:function(x,logp){return dt(df,logp)(x)},p:function(q,lowerTail,logp){return pt(df,lowerTail,logp)(q)},q:function(p,lowerTail,logp){return qt(df,lowerTail,logp)(p)},r:function(n){return rt(df)(n)}}},dt:dt,pt:pt,qt:qt,rt:rt}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../basicFunc/bd0":3,"../basicFunc/bratio":4,"../basicFunc/log1p":11,"../basicFunc/stirlerr":14,"../constants":16,"../rgen/rgen":31,"../utils":32}],25:[function(require,module){!function(define){"use strict";define(function(require){function dunif(min,max,logp){return logp=logp===!0,max>min?function(x){var p;return p=min>x||x>max?0:1/(max-min),logp?Math.log(p):p}:function(){return 0/0}}function punif(min,max,lowerTail,logp){return logp=logp===!0,lowerTail=lowerTail!==!1,max>min?function(x){var p;return p=min>=x?0:x>=max?1:(x-min)/(max-min),p=lowerTail?p:1-p,logp?Math.log(p):p}:function(){return 0/0}}function qunif(min,max,lowerTail,logp){return logp=logp===!0,lowerTail=lowerTail!==!1,max>min?function(p){return p=logp?Math.exp(p):p,0>p||p>1?0/0:lowerTail?min+p*(max-min):max-p*(max-min)}:function(){return 0/0}}function runif(min,max){return function(){return min+(max-min)*rgen.random()}}var rgen;return rgen=require("../rgen/rgen"),{unif:function(min,max){return{d:function(x,logp){return dunif(min,max,logp)(x)},p:function(q,lowerTail,logp){return punif(min,max,lowerTail,logp)(q)},q:function(p,lowerTail,logp){return qunif(min,max,lowerTail,logp)(p)},r:function(n){return runif(min,max)(n)}}},dunif:dunif,punif:punif,qunif:qunif,runif:runif}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"../rgen/rgen":31}],26:[function(require,module){!function(define){"use strict";define(function(){function Polynomial(coefs){return coefs instanceof Polynomial?coefs:void(this.coefs=coefs)}return Polynomial.new=function(coefs){return new Polynomial(coefs)},Polynomial.prototype.evalAt=function(x){return this.coefs.reduce(function(acc,coef){return acc*x+coef},0)},Polynomial})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{}],27:[function(require,module){!function(define){"use strict";define(function(require){function Rational(num,denom){this.num=new Polynomial(num),this.denom=new Polynomial(denom)}var Polynomial=require("./polynomial");return Rational.new=function(num,denom){return new Rational(num,denom)},Rational.prototype.evalAt=function(x){return this.num.evalAt(x)/this.denom.evalAt(x)},Rational})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"./polynomial":26}],28:[function(require,module){!function(define){"use strict";define(function(){function slcg(a,c,m){function random(){var k;for(k=Math.floor(x/q),x=a*(x-k*q)-k*r+c;0>x;)x+=m;return x/m}function setSeed(i){return x=i,this}var x,q,r;return q=Math.floor(m/a),r=m%a,{random:random,setSeed:setSeed}}return slcg})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{}],29:[function(require,module){!function(define){"use strict";define(function(require){var rgen;return rgen=require("./rgen"),function(lambda){return function(){return-Math.log(rgen.random())/lambda}}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"./rgen":31}],30:[function(require,module){!function(define){"use strict";define(function(require){function getNext(first,second){if(first.update())return first;if(second.update())return second;throw new Error("both sides exhausted -- error!")}var rgen;return rgen=require("./rgen"),function(getMode,updateLeft,updateRight){var mode,left,right;return mode=getMode.apply(this,arguments),left={update:updateLeft},right={update:updateRight},function(){var current,u;left.val=right.val=mode.val,left.prob=right.prob=mode.prob,current=right,u=rgen.random();do{if(u<=current.prob)return current.val;u-=current.prob,current=current===left?getNext(right,left):getNext(left,right)}while(u>=0);throw new Error("total probability exceeds 1")}}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"./rgen":31}],31:[function(require,module){!function(define){"use strict";define(function(require){var rgen,slcg;return rgen={algorithms:{},setSeed:function(){throw new Error("need to select an algorithm first")},random:function(){throw new Error("need to select an algorithm first")},setAlgorithm:function(name){return rgen.random=rgen.algorithms[name].random,rgen.setSeed=rgen.algorithms[name].setSeed,rgen.setRandomSeed()},getAlgorithms:function(){return Object.keys(rgen.algorithms)}},rgen.setRandomSeed=function(){return rgen.setSeed(new Date)},slcg=require("./algorithms/slcg"),rgen.algorithms.slcg=slcg(16807,0,Math.pow(2,31)-1),rgen.setAlgorithm("slcg"),rgen})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"./algorithms/slcg":28}],32:[function(require,module){!function(define){"use strict";define(function(require){function inferEndpoint(f,y,lower,e){var comp;if(null!=e)return e;for(e=lower?-1:1,comp=f(e)<f(2*e);f(e)>y!==comp;)if(e=2*e,-e>1e200)throw new Error("lower");return e}var utils,log1p,expm1;return log1p=require("./basicFunc/log1p").log1p,expm1=require("./basicFunc/expm1").expm1,utils={mixin:function(target){return Array.prototype.slice.call(arguments,1).forEach(function(source){Object.keys(source).forEach(function(key){target[key]=source[key]})}),target},maxSteps:1e3,repeat:function(init,step,stop){var prev,curr,done,reps;if(curr=init,reps=utils.maxSteps,0===stop)return curr;for(done="function"==typeof stop?stop:stop>0?function(){return stop-=1,0===stop}:function(){return utils.relativelyCloseTo(curr,prev,1e-13)};reps>0&&!done()&&!isNaN(curr);)reps-=1,prev=curr,curr=step();return isNaN(curr)&&console.log("repeat returned NaN"),0===reps&&console.log("repeat terminated after too many repetitions"),curr},series:function(f,stop){var sum,curr,i;return i=0,curr=f(0),sum=curr,utils.repeat(sum,function(){return i+=1,curr=f(i,curr),sum+=curr},stop)},contFrac:function(a,b,stop){var A,A1,A2,B,B1,B2,an,bn,i;return an=a(0),A=an,A1=1,bn=1,B=bn,B1=0,i=0,utils.repeat(A/B,function(){return A2=A1,A1=A,B2=B1,B1=B,i+=1,an=a(i,an),bn=b(i,bn),A=A1*an+A2*bn,B=B1*an+B2*bn,A/B},stop)},binSearchSolve:function binSearchSolve(f,y,a,b){var mid,vmid,niters;if(a=inferEndpoint(f,y,!0,a),b=inferEndpoint(f,y,!1,b),f(a)>f(b))return binSearchSolve(function(x){return-f(x)},-y,a,b);if(utils.relativelyCloseTo(f(a),y))return a;if(utils.relativelyCloseTo(f(b),y))return b;if(f(a)>y||f(b)<y)throw new Error("Binary search: Desired value not between endpoint values.");for(niters=0;niters<utils.maxSteps;){if(mid=(a+b)/2,niters+=1,vmid=f(mid),utils.relativelyCloseTo(a,b)&&utils.relativelyCloseTo(vmid,y))return mid;y>vmid?a=mid:b=mid}throw new Error("Binary search: Too many iterations")},discInvCdf:function(min,max,x,p,f){var incr;if(0===p)return min;for(1===p&&(x=max),x>max&&(x=max),min>x&&(x=min),incr=Math.min(x-min,max-x),incr=Math.max(Math.floor(.001*incr),1);incr>1;)f(x)<p?(x+=incr,f(x)>=p&&(incr=Math.floor(incr/2))):(x-=incr,f(x)<p&&(incr=Math.floor(incr/2)));for(min>x&&(x=min),x>max&&(x=max);;)if(x===min){if(f(x)>=p||utils.relativelyCloseTo(f(x),p,1e-14))return x;x+=1}else if(f(x-1)>=p||utils.relativelyCloseTo(f(x-1),p,1e-14)){if(Math.abs(f(x)-p)<Math.abs(f(x-1)-p))return x;x-=1}else{if(x===max||f(x)>=p||utils.relativelyCloseTo(f(x),p,1e-14))return x;x+=1}},precision:1e-10,relativelyCloseTo:function(x,x0,delta){delta=delta||utils.precision;var absMax=Math.max(Math.abs(x0),Math.abs(x));return isNaN(absMax)?isNaN(x)&&isNaN(x0):1/0===absMax?x0===x:0===absMax?!0:0===x?utils.isEssentiallyZero(x0):0===x0?utils.isEssentiallyZero(x):Math.abs(x-x0)/absMax<delta},isEssentiallyZero:function(x){return Math.abs(x)<1e-100},logspaceAdd:function(lx,ly){return Math.max(lx,ly)+log1p(Math.exp(-Math.abs(lx-ly)))},pWrap:function(lowerTail,logp,f){return function(prob){return prob=logp?lowerTail?Math.exp(prob):-expm1(prob):lowerTail?prob:1-prob,prob>=0&&1>=prob?f(prob):0/0}}}})}("function"==typeof define&&define.amd?define:function(factory){"use strict";module.exports=factory(require)})},{"./basicFunc/expm1":6,"./basicFunc/log1p":11}]},{},[1]);