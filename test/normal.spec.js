var main = require('..');
var utils = require('../panthrMath/utils');
var normal = require('../panthrMath/distributions/normal');
var chai = require('chai');
var expect = chai.expect;

var precision = 1e-10;

   /* Rcode generating the tests:
      options(digits = 20)
      xs2 = seq(-22, 22, 0.1)
      xs2 = signif(xs2, digits=15)
      norms2 = dnorm(xs2, log = TRUE)
      ps2 = pnorm(xs2, lower.tail = TRUE, log.p=TRUE)
      qs2 = pnorm(xs2, lower.tail = FALSE, log.p=TRUE)
      xs2 = formatC(xs2, digits=15, format="g")
      ps2 = formatC(ps2, digits=15, format="g")
      qs2 = formatC(qs2, digits=15, format="g")

      s = paste(xs2, norms2, sep=", ", collapse="],\n[")
      s = paste("[", s, "]", sep="")

      s2 = paste(xs2, ps2, qs2, sep=", ", collapse="],\n[")
      s2 = paste("[", s2, "]", sep="")
    */

describe('Normal Distribution', function() {
   it('dnorm', function() {
      [
[             -20, -200.918938533205],
[           -19.9, -198.923938533205],
[           -19.8, -196.938938533205],
[           -19.7, -194.963938533205],
[           -19.6, -192.998938533205],
[           -19.5, -191.043938533205],
[           -19.4, -189.098938533205],
[           -19.3, -187.163938533205],
[           -19.2, -185.238938533205],
[           -19.1, -183.323938533205],
[             -19, -181.418938533205],
[           -18.9, -179.523938533205],
[           -18.8, -177.638938533205],
[           -18.7, -175.763938533205],
[           -18.6, -173.898938533205],
[           -18.5, -172.043938533205],
[           -18.4, -170.198938533205],
[           -18.3, -168.363938533205],
[           -18.2, -166.538938533205],
[           -18.1, -164.723938533205],
[             -18, -162.918938533205],
[           -17.9, -161.123938533205],
[           -17.8, -159.338938533205],
[           -17.7, -157.563938533205],
[           -17.6, -155.798938533205],
[           -17.5, -154.043938533205],
[           -17.4, -152.298938533205],
[           -17.3, -150.563938533205],
[           -17.2, -148.838938533205],
[           -17.1, -147.123938533205],
[             -17, -145.418938533205],
[           -16.9, -143.723938533205],
[           -16.8, -142.038938533205],
[           -16.7, -140.363938533205],
[           -16.6, -138.698938533205],
[           -16.5, -137.043938533205],
[           -16.4, -135.398938533205],
[           -16.3, -133.763938533205],
[           -16.2, -132.138938533205],
[           -16.1, -130.523938533205],
[             -16, -128.918938533205],
[           -15.9, -127.323938533205],
[           -15.8, -125.738938533205],
[           -15.7, -124.163938533205],
[           -15.6, -122.598938533205],
[           -15.5, -121.043938533205],
[           -15.4, -119.498938533205],
[           -15.3, -117.963938533205],
[           -15.2, -116.438938533205],
[           -15.1, -114.923938533205],
[             -15, -113.418938533205],
[           -14.9, -111.923938533205],
[           -14.8, -110.438938533205],
[           -14.7, -108.963938533205],
[           -14.6, -107.498938533205],
[           -14.5, -106.043938533205],
[           -14.4, -104.598938533205],
[           -14.3, -103.163938533205],
[           -14.2, -101.738938533205],
[           -14.1, -100.323938533205],
[             -14, -98.9189385332047],
[           -13.9, -97.5239385332047],
[           -13.8, -96.1389385332047],
[           -13.7, -94.7639385332047],
[           -13.6, -93.3989385332047],
[           -13.5, -92.0439385332047],
[           -13.4, -90.6989385332047],
[           -13.3, -89.3639385332047],
[           -13.2, -88.0389385332047],
[           -13.1, -86.7239385332047],
[             -13, -85.4189385332047],
[           -12.9, -84.1239385332047],
[           -12.8, -82.8389385332047],
[           -12.7, -81.5639385332047],
[           -12.6, -80.2989385332047],
[           -12.5, -79.0439385332047],
[           -12.4, -77.7989385332047],
[           -12.3, -76.5639385332047],
[           -12.2, -75.3389385332047],
[           -12.1, -74.1239385332047],
[             -12, -72.9189385332047],
[           -11.9, -71.7239385332047],
[           -11.8, -70.5389385332047],
[           -11.7, -69.3639385332047],
[           -11.6, -68.1989385332047],
[           -11.5, -67.0439385332047],
[           -11.4, -65.8989385332047],
[           -11.3, -64.7639385332047],
[           -11.2, -63.6389385332047],
[           -11.1, -62.5239385332047],
[             -11, -61.4189385332047],
[           -10.9, -60.3239385332047],
[           -10.8, -59.2389385332047],
[           -10.7, -58.1639385332047],
[           -10.6, -57.0989385332047],
[           -10.5, -56.0439385332047],
[           -10.4, -54.9989385332047],
[           -10.3, -53.9639385332047],
[           -10.2, -52.9389385332047],
[           -10.1, -51.9239385332047],
[             -10, -50.9189385332047],
[            -9.9, -49.9239385332047],
[            -9.8, -48.9389385332047],
[            -9.7, -47.9639385332047],
[            -9.6, -46.9989385332047],
[            -9.5, -46.0439385332047],
[            -9.4, -45.0989385332047],
[            -9.3, -44.1639385332047],
[            -9.2, -43.2389385332047],
[            -9.1, -42.3239385332047],
[              -9, -41.4189385332047],
[            -8.9, -40.5239385332047],
[            -8.8, -39.6389385332047],
[            -8.7, -38.7639385332047],
[            -8.6, -37.8989385332047],
[            -8.5, -37.0439385332047],
[            -8.4, -36.1989385332047],
[            -8.3, -35.3639385332047],
[            -8.2, -34.5389385332047],
[            -8.1, -33.7239385332047],
[              -8, -32.9189385332047],
[            -7.9, -32.1239385332047],
[            -7.8, -31.3389385332047],
[            -7.7, -30.5639385332047],
[            -7.6, -29.7989385332047],
[            -7.5, -29.0439385332047],
[            -7.4, -28.2989385332047],
[            -7.3, -27.5639385332047],
[            -7.2, -26.8389385332047],
[            -7.1, -26.1239385332047],
[              -7, -25.4189385332047],
[            -6.9, -24.7239385332047],
[            -6.8, -24.0389385332047],
[            -6.7, -23.3639385332047],
[            -6.6, -22.6989385332047],
[            -6.5, -22.0439385332047],
[            -6.4, -21.3989385332047],
[            -6.3, -20.7639385332047],
[            -6.2, -20.1389385332047],
[            -6.1, -19.5239385332047],
[              -6, -18.9189385332047],
[            -5.9, -18.3239385332047],
[            -5.8, -17.7389385332047],
[            -5.7, -17.1639385332047],
[            -5.6, -16.5989385332047],
[            -5.5, -16.0439385332047],
[            -5.4, -15.4989385332047],
[            -5.3, -14.9639385332047],
[            -5.2, -14.4389385332047],
[            -5.1, -13.9239385332047],
[              -5, -13.4189385332047],
[            -4.9, -12.9239385332047],
[            -4.8, -12.4389385332047],
[            -4.7, -11.9639385332047],
[            -4.6, -11.4989385332047],
[            -4.5, -11.0439385332047],
[            -4.4, -10.5989385332047],
[            -4.3, -10.1639385332047],
[            -4.2, -9.73893853320467],
[            -4.1, -9.32393853320467],
[              -4, -8.91893853320467],
[            -3.9, -8.52393853320467],
[            -3.8, -8.13893853320467],
[            -3.7, -7.76393853320467],
[            -3.6, -7.39893853320467],
[            -3.5, -7.04393853320467],
[            -3.4, -6.69893853320467],
[            -3.3, -6.36393853320467],
[            -3.2, -6.03893853320467],
[            -3.1, -5.72393853320467],
[              -3, -5.41893853320467],
[            -2.9, -5.12393853320467],
[            -2.8, -4.83893853320467],
[            -2.7, -4.56393853320467],
[            -2.6, -4.29893853320467],
[            -2.5, -4.04393853320467],
[            -2.4, -3.79893853320467],
[            -2.3, -3.56393853320467],
[            -2.2, -3.33893853320467],
[            -2.1, -3.12393853320467],
[              -2, -2.91893853320467],
[            -1.9, -2.72393853320467],
[            -1.8, -2.53893853320467],
[            -1.7, -2.36393853320467],
[            -1.6, -2.19893853320467],
[            -1.5, -2.04393853320467],
[            -1.4, -1.89893853320467],
[            -1.3, -1.76393853320467],
[            -1.2, -1.63893853320467],
[            -1.1, -1.52393853320467],
[              -1, -1.41893853320467],
[-0.899999999999999, -1.32393853320467],
[-0.799999999999997, -1.23893853320467],
[-0.699999999999999, -1.16393853320467],
[-0.599999999999998, -1.09893853320467],
[            -0.5, -1.04393853320467],
[-0.399999999999999, -0.998938533204672],
[-0.299999999999997, -0.963938533204672],
[-0.199999999999999, -0.938938533204673],
[-0.0999999999999979, -0.923938533204673],
[               0, -0.918938533204673],
[0.100000000000001, -0.923938533204673],
[0.200000000000003, -0.938938533204673],
[0.300000000000001, -0.963938533204673],
[0.400000000000002, -0.998938533204674],
[             0.5, -1.04393853320467],
[0.600000000000001, -1.09893853320467],
[0.700000000000003, -1.16393853320467],
[0.800000000000001, -1.23893853320467],
[0.900000000000002, -1.32393853320467],
[               1, -1.41893853320467],
[             1.1, -1.52393853320467],
[             1.2, -1.63893853320467],
[             1.3, -1.76393853320467],
[             1.4, -1.89893853320467],
[             1.5, -2.04393853320467],
[             1.6, -2.19893853320467],
[             1.7, -2.36393853320467],
[             1.8, -2.53893853320467],
[             1.9, -2.72393853320467],
[               2, -2.91893853320467],
[             2.1, -3.12393853320467],
[             2.2, -3.33893853320467],
[             2.3, -3.56393853320467],
[             2.4, -3.79893853320467],
[             2.5, -4.04393853320467],
[             2.6, -4.29893853320467],
[             2.7, -4.56393853320467],
[             2.8, -4.83893853320467],
[             2.9, -5.12393853320467],
[               3, -5.41893853320467],
[             3.1, -5.72393853320467],
[             3.2, -6.03893853320467],
[             3.3, -6.36393853320467],
[             3.4, -6.69893853320467],
[             3.5, -7.04393853320467],
[             3.6, -7.39893853320467],
[             3.7, -7.76393853320467],
[             3.8, -8.13893853320467],
[             3.9, -8.52393853320467],
[               4, -8.91893853320467],
[             4.1, -9.32393853320467],
[             4.2, -9.73893853320467],
[             4.3, -10.1639385332047],
[             4.4, -10.5989385332047],
[             4.5, -11.0439385332047],
[             4.6, -11.4989385332047],
[             4.7, -11.9639385332047],
[             4.8, -12.4389385332047],
[             4.9, -12.9239385332047],
[               5, -13.4189385332047],
[             5.1, -13.9239385332047],
[             5.2, -14.4389385332047],
[             5.3, -14.9639385332047],
[             5.4, -15.4989385332047],
[             5.5, -16.0439385332047],
[             5.6, -16.5989385332047],
[             5.7, -17.1639385332047],
[             5.8, -17.7389385332047],
[             5.9, -18.3239385332047],
[               6, -18.9189385332047],
[             6.1, -19.5239385332047],
[             6.2, -20.1389385332047],
[             6.3, -20.7639385332047],
[             6.4, -21.3989385332047],
[             6.5, -22.0439385332047],
[             6.6, -22.6989385332047],
[             6.7, -23.3639385332047],
[             6.8, -24.0389385332047],
[             6.9, -24.7239385332047],
[               7, -25.4189385332047],
[             7.1, -26.1239385332047],
[             7.2, -26.8389385332047],
[             7.3, -27.5639385332047],
[             7.4, -28.2989385332047],
[             7.5, -29.0439385332047],
[             7.6, -29.7989385332047],
[             7.7, -30.5639385332047],
[             7.8, -31.3389385332047],
[             7.9, -32.1239385332047],
[               8, -32.9189385332047],
[             8.1, -33.7239385332047],
[             8.2, -34.5389385332047],
[             8.3, -35.3639385332047],
[             8.4, -36.1989385332047],
[             8.5, -37.0439385332047],
[             8.6, -37.8989385332047],
[             8.7, -38.7639385332047],
[             8.8, -39.6389385332047],
[             8.9, -40.5239385332047],
[               9, -41.4189385332047],
[             9.1, -42.3239385332047],
[             9.2, -43.2389385332047],
[             9.3, -44.1639385332047],
[             9.4, -45.0989385332047],
[             9.5, -46.0439385332047],
[             9.6, -46.9989385332047],
[             9.7, -47.9639385332047],
[             9.8, -48.9389385332047],
[             9.9, -49.9239385332047],
[              10, -50.9189385332047],
[            10.1, -51.9239385332047],
[            10.2, -52.9389385332047],
[            10.3, -53.9639385332047],
[            10.4, -54.9989385332047],
[            10.5, -56.0439385332047],
[            10.6, -57.0989385332047],
[            10.7, -58.1639385332047],
[            10.8, -59.2389385332047],
[            10.9, -60.3239385332047],
[              11, -61.4189385332047],
[            11.1, -62.5239385332047],
[            11.2, -63.6389385332047],
[            11.3, -64.7639385332047],
[            11.4, -65.8989385332047],
[            11.5, -67.0439385332047],
[            11.6, -68.1989385332047],
[            11.7, -69.3639385332047],
[            11.8, -70.5389385332047],
[            11.9, -71.7239385332047],
[              12, -72.9189385332047],
[            12.1, -74.1239385332047],
[            12.2, -75.3389385332047],
[            12.3, -76.5639385332047],
[            12.4, -77.7989385332047],
[            12.5, -79.0439385332047],
[            12.6, -80.2989385332047],
[            12.7, -81.5639385332047],
[            12.8, -82.8389385332047],
[            12.9, -84.1239385332047],
[              13, -85.4189385332047],
[            13.1, -86.7239385332047],
[            13.2, -88.0389385332047],
[            13.3, -89.3639385332047],
[            13.4, -90.6989385332047],
[            13.5, -92.0439385332047],
[            13.6, -93.3989385332047],
[            13.7, -94.7639385332047],
[            13.8, -96.1389385332047],
[            13.9, -97.5239385332047],
[              14, -98.9189385332047],
[            14.1, -100.323938533205],
[            14.2, -101.738938533205],
[            14.3, -103.163938533205],
[            14.4, -104.598938533205],
[            14.5, -106.043938533205],
[            14.6, -107.498938533205],
[            14.7, -108.963938533205],
[            14.8, -110.438938533205],
[            14.9, -111.923938533205],
[              15, -113.418938533205],
[            15.1, -114.923938533205],
[            15.2, -116.438938533205],
[            15.3, -117.963938533205],
[            15.4, -119.498938533205],
[            15.5, -121.043938533205],
[            15.6, -122.598938533205],
[            15.7, -124.163938533205],
[            15.8, -125.738938533205],
[            15.9, -127.323938533205],
[              16, -128.918938533205],
[            16.1, -130.523938533205],
[            16.2, -132.138938533205],
[            16.3, -133.763938533205],
[            16.4, -135.398938533205],
[            16.5, -137.043938533205],
[            16.6, -138.698938533205],
[            16.7, -140.363938533205],
[            16.8, -142.038938533205],
[            16.9, -143.723938533205],
[              17, -145.418938533205],
[            17.1, -147.123938533205],
[            17.2, -148.838938533205],
[            17.3, -150.563938533205],
[            17.4, -152.298938533205],
[            17.5, -154.043938533205],
[            17.6, -155.798938533205],
[            17.7, -157.563938533205],
[            17.8, -159.338938533205],
[            17.9, -161.123938533205],
[              18, -162.918938533205],
[            18.1, -164.723938533205],
[            18.2, -166.538938533205],
[            18.3, -168.363938533205],
[            18.4, -170.198938533205],
[            18.5, -172.043938533205],
[            18.6, -173.898938533205],
[            18.7, -175.763938533205],
[            18.8, -177.638938533205],
[            18.9, -179.523938533205],
[              19, -181.418938533205],
[            19.1, -183.323938533205],
[            19.2, -185.238938533205],
[            19.3, -187.163938533205],
[            19.4, -189.098938533205],
[            19.5, -191.043938533205],
[            19.6, -192.998938533205],
[            19.7, -194.963938533205],
[            19.8, -196.938938533205],
[            19.9, -198.923938533205],
[              20, -200.918938533205]
      ].forEach(function(pair) {
         expect(utils.relativelyCloseTo(
            normal.dnorm(0, 1, true, true)(pair[0]), pair[1], precision)).to.be.ok;
         var mu = Math.random() * 50 - 50, sigma = Math.random() * 10 + 0.00001;
         expect(utils.relativelyCloseTo(
            normal.dnorm(mu, sigma, true, true)(mu + sigma * pair[0]),
            pair[1] - Math.log(sigma), precision)).to.be.ok;
      });
   });
   it('pnorm and qnorm', function() {
      [
[             -22, -246.012036537381, -1.43989243514508e-107],
[           -21.9, -243.812499439254, -1.29890346246158e-106],
[           -21.8, -241.622941747047, -1.16008469725442e-105],
[           -21.7, -239.443363273729, -1.02581395269687e-104],
[           -21.6, -237.273763829717, -8.98077194814038e-104],
[           -21.5, -235.114143222833, -7.78439707718263e-103],
[           -21.4, -232.964501258258, -6.6804024125533e-102],
[           -21.3, -230.824837738482, -5.67605616213548e-101],
[           -21.2, -228.695152463252, -4.77482267039508e-100],
[           -21.1, -226.575445229525, -3.97680596952967e-99],
[             -21, -224.465715831414, -3.27927801897904e-98],
[           -20.9, -222.365964060138, -2.67724949663741e-97],
[           -20.8, -220.276189703963, -2.16404514688054e-96],
[           -20.7, -218.196392548148, -1.73185187901974e-95],
[           -20.6, -216.12657237489, -1.37221519757791e-94],
[           -20.5, -214.066728963264, -1.0764673258791e-93],
[           -20.4, -212.016862089164, -8.3607786213281e-93],
[           -20.3, -209.976971525242, -6.42924446769835e-92],
[           -20.2, -207.947057040844, -4.89486365476525e-91],
[           -20.1, -205.927118401948, -3.68968086372139e-90],
[             -20, -203.917155371097, -2.75362411860623e-89],
[           -19.9, -201.917167707333, -2.03464320878273e-88],
[           -19.8, -199.927155166125, -1.48846877588926e-87],
[           -19.7, -197.947117499304, -1.07810028636623e-86],
[           -19.6, -195.977054454985, -7.73119576813146e-86],
[           -19.5, -194.016965777497, -5.48911547566041e-85],
[           -19.4, -192.066851207306, -3.85856982898133e-84],
[           -19.3, -190.126710480934, -2.68546054279922e-83],
[           -19.2, -188.196543330883, -1.85046006994254e-82],
[           -19.1, -186.276349485555, -1.26243582218532e-81],
[             -19, -184.366128669161, -8.52722395263098e-81],
[           -18.9, -182.465880601641, -5.7026263842317e-80],
[           -18.8, -180.575604998575, -3.77581913269241e-79],
[           -18.7, -178.695301571088, -2.47523584514254e-78],
[           -18.6, -176.824970025765, -1.60653893432569e-77],
[           -18.5, -174.964610064547, -1.03236986895633e-76],
[           -18.4, -173.11422138464, -6.56823849338697e-76],
[           -18.3, -171.273803678411, -4.13744437350469e-75],
[           -18.2, -169.443356633286, -2.58038922065181e-74],
[           -18.1, -167.622879931646, -1.59333906788398e-73],
[             -18, -165.812373250714, -9.74094891893715e-73],
[           -17.9, -164.011836262448, -5.89609597726308e-72],
[           -17.8, -162.221268633423, -3.53344377541376e-71],
[           -17.7, -160.440670024717, -2.09653605431778e-70],
[           -17.6, -158.670040091787, -1.23162116859459e-69],
[           -17.5, -156.909378484346, -7.16345876623504e-69],
[           -17.4, -155.158684846236, -4.12514626507903e-68],
[           -17.3, -153.417958815295, -2.35194445880923e-67],
[           -17.2, -151.687200023225, -1.32765750427179e-66],
[           -17.1, -149.966408095452, -7.4202150716403e-66],
[             -17, -148.25558265098, -4.10599620209891e-65],
[           -16.9, -146.554723302254, -2.24953302305127e-64],
[           -16.8, -144.863829654997, -1.22022004059762e-63],
[           -16.7, -143.182901308066, -6.55323978194241e-63],
[           -16.6, -141.511937853285, -3.48454651995033e-62],
[           -16.5, -139.850938875285, -1.83446300316473e-61],
[           -16.4, -138.199903951333, -9.56190257423199e-61],
[           -16.3, -136.558832651159, -4.93460647706621e-60],
[           -16.2, -134.927724536778, -2.52135372531011e-59],
[           -16.1, -133.306579162304, -1.27552292445016e-58],
[             -16, -131.69539607376, -6.38875440053809e-58],
[           -15.9, -130.094174808885, -3.16823766537965e-57],
[           -15.8, -128.502914896931, -1.55558286895012e-56],
[           -15.7, -126.921615858455, -7.56210317468378e-56],
[           -15.6, -125.350277205108, -3.63970600148676e-55],
[           -15.5, -123.78889843941, -1.73446079179387e-54],
[           -15.4, -122.237479054528, -8.18346755401425e-54],
[           -15.3, -120.696018534037, -3.82283156207345e-53],
[           -15.2, -119.164516351684, -1.76810523412223e-52],
[           -15.1, -117.642971971133, -8.09666998801522e-52],
[             -15, -116.131384845712, -3.67096619931275e-51],
[           -14.9, -114.629754418147, -1.6478974977e-50],
[           -14.8, -113.138080120289, -7.32413111982709e-50],
[           -14.7, -111.656361372828, -3.22298575774484e-49],
[           -14.6, -110.184597585008, -1.40422686696265e-48],
[           -14.5, -108.72278815432, -6.05749476441522e-48],
[           -14.4, -107.270932466194, -2.58717592540225e-47],
[           -14.3, -105.829029893676, -1.0940477870189e-46],
[           -14.2, -104.397079797098, -4.58062055189479e-46],
[           -14.1, -102.975081523735, -1.89884852122918e-45],
[             -14, -101.56303440745, -7.7935368191928e-45],
[           -13.9, -100.160937768326, -3.16706826813078e-44],
[           -13.8, -98.7687909122893, -1.27426314550684e-43],
[           -13.7, -97.3865931307175, -5.07621481159788e-43],
[           -13.6, -96.0143437000327, -2.0021672236815e-42],
[           -13.5, -94.6520418812829, -7.81880730565789e-42],
[           -13.4, -93.2996869197074, -3.02315773594517e-41],
[           -13.3, -91.957278044288, -1.15734162836903e-40],
[           -13.2, -90.6248144672827, -4.38675271307425e-40],
[           -13.1, -89.3022953837447, -1.64628830695087e-39],
[             -13, -87.9897199710225, -6.11716439954988e-39],
[           -12.9, -86.6870873882429, -2.25048589341506e-38],
[           -12.8, -85.3943967757747, -8.19756171316293e-38],
[           -12.7, -84.1116472546732, -2.95648536485205e-37],
[           -12.6, -82.8388379261036, -1.05572255808865e-36],
[           -12.5, -81.5759678707439, -3.73256429887771e-36],
[           -12.4, -80.3230361481642, -1.30661798312463e-35],
[           -12.3, -79.080041796184, -4.52870695615879e-35],
[           -12.2, -77.846983830204, -1.55411978638961e-34],
[           -12.1, -76.6238612425132, -5.28055876743356e-34],
[             -12, -75.4106730015688, -1.77648211207768e-33],
[           -11.9, -74.2074180512483, -5.91735771630608e-33],
[           -11.8, -73.0140953100728, -1.95155729316955e-32],
[           -11.7, -71.8307036703992, -6.37267491568616e-32],
[           -11.6, -70.6572419975811, -2.06039123615879e-31],
[           -11.5, -69.4937091290954, -6.59577144611367e-31],
[           -11.4, -68.3401038736343, -2.09059542173855e-30],
[           -11.3, -67.1964250101611, -6.56089994090416e-30],
[           -11.2, -66.062671286926, -2.03866750354489e-29],
[           -11.1, -64.938841420443, -6.27219439321705e-29],
[             -11, -63.8249340944237, -1.91065957449868e-28],
[           -10.9, -62.7209479586665, -5.76286441383559e-28],
[           -10.8, -61.6268816278996, -1.72101783947978e-27],
[           -10.7, -60.5427336805745, -5.08891085502732e-27],
[           -10.6, -59.4685026576087, -1.48990112729648e-26],
[           -10.5, -58.4041870610732, -4.31900631780923e-26],
[           -10.4, -57.3497853528244, -1.239665979584e-25],
[           -10.3, -56.305295953075, -3.52306507892641e-25],
[           -10.2, -55.2707172389029, -9.91362512256007e-25],
[           -10.1, -54.2460475426936, -2.76210947176452e-24],
[             -10, -53.2312851505125, -7.61985302416053e-24],
[            -9.9, -52.226428300404, -2.08137521949321e-23],
[            -9.8, -51.231475180614, -5.62928231137653e-23],
[            -9.7, -50.2464239277293, -1.5074931688102e-22],
[            -9.6, -49.2712726247324, -3.99722120572624e-22],
[            -9.5, -48.3060192989652, -1.04945150753626e-21],
[            -9.4, -47.3506619199965, -2.72815357134612e-21],
[            -9.3, -46.4051983973889, -7.02228424044163e-21],
[            -9.2, -45.469626578359, -1.78974881201405e-20],
[            -9.1, -44.5439442453245, -4.51659149143546e-20],
[              -9, -43.6281491133321, -1.12858840595384e-19],
[            -8.9, -42.7222388273597, -2.79233437493965e-19],
[            -8.8, -41.8262109594845, -6.84080768593555e-19],
[            -8.7, -40.9400630059101, -1.65942086996478e-18],
[            -8.6, -40.0637923838442, -3.98580496284818e-18],
[            -8.5, -39.1973964282177, -9.47953482220332e-18],
[            -8.4, -38.3408723882352, -2.23239319728804e-17],
[            -8.3, -37.4942174237483, -5.20556974489026e-17],
[            -8.2, -36.6574286014387, -1.20193515427359e-16],
[            -8.1, -35.8305028908015, -2.74795939239823e-16],
[              -8, -35.0134371599146, -6.22096057427179e-16],
[            -7.9, -34.2062281709817, -1.39451714665927e-15],
[            -7.8, -33.4088725756349, -3.0953587719587e-15],
[            -7.7, -32.6213669099801, -6.80331154077398e-15],
[            -7.6, -31.8437075893706, -1.48065374900482e-14],
[            -7.5,  -31.07589090289, -3.19089167291095e-14],
[            -7.4, -30.3179130075253, -6.80922489062025e-14],
[            -7.3, -29.5697699220113, -1.43883863815769e-13],
[            -7.2, -28.8314575203219, -3.01062798111789e-13],
[            -7.1, -28.1029715247876, -6.23784446333354e-13],
[              -7, -27.3843074988111, -1.27981254388665e-12],
[            -6.9, -26.6754608391556, -2.60012696564155e-12],
[            -6.8, -25.9764267677755, -5.23095754415828e-12],
[            -6.7, -25.2872003231574, -1.04209769880195e-11],
[            -6.6, -24.6077763511381, -2.05578890942065e-11],
[            -6.5, -23.9381494951618, -4.01600058393976e-11],
[            -6.4, -23.2783141859372, -7.76884758201159e-11],
[            -6.3,  -22.62826463045, -1.48822822187305e-10],
[            -6.2, -21.9879948002866, -2.82315803744178e-10],
[            -6.1, -21.3574984192156, -5.30342326435516e-10],
[              -6, -20.7367689499747, -9.86587645524376e-10],
[            -5.9, -20.1257995802032, -1.8175078647511e-09],
[            -5.8, -19.524583207455, -3.31574598382325e-09],
[            -5.7, -18.9331124232247, -5.9903714190058e-09],
[            -5.6, -18.3513794959093, -1.07175903157443e-08],
[            -5.5, -17.7793763526253, -1.89895626461895e-08],
[            -5.4, -17.2170945597915, -3.33204490405547e-08],
[            -5.3, -16.6645253023825, -5.79013420759286e-08],
[            -5.2, -16.1216593617458, -9.96442681338246e-08],
[            -5.1, -15.5884870918715, -1.69826755135323e-07],
[              -5, -15.0649983939887, -2.86651612963764e-07],
[            -4.9, -14.5511826893553, -4.79183391398662e-07],
[            -4.8, -14.0470288900935, -7.9332846666054e-07],
[            -4.7, -13.5525253679131, -1.30080829996803e-06],
[            -4.6, -13.0676599205472, -2.11245693373843e-06],
[            -4.5, -12.5924197357131, -3.39767889683447e-06],
[            -4.4, -12.1267913523907, -5.41255855557248e-06],
[            -4.3, -11.6707606191956, -8.53994193619215e-06],
[            -4.2, -11.2243126496011, -1.33458380712071e-05],
[            -4.1, -10.7874317737446, -2.06577202817811e-05],
[              -4, -10.3601014865273, -3.16717433774893e-05],
[            -3.9, -9.94230439169136, -4.80975006838444e-05],
[            -3.8, -9.53402214153257, -7.23506611710858e-05],
[            -3.7, -9.13523537187288, -0.000107805544286263],
[            -3.6, -8.7459236318874, -0.000159121249272065],
[            -3.5, -8.36606530834409, -0.000232656141376804],
[            -3.4, -7.99563754377665, -0.000336986039094691],
[            -3.3, -7.63461614807113, -0.00048354102950672],
[            -3.2, -7.28297550290363, -0.00068737412539049],
[            -3.1, -6.94068845842123, -0.000968071643401549],
[              -3, -6.60772622151035, -0.00135080996474819],
[            -2.9, -6.28405823494742, -0.00186755609818092],
[            -2.8, -5.96965204667521, -0.00255840024716059],
[            -2.7, -5.66447316839644, -0.00347299768383746],
[            -2.6, -5.36848492262427, -0.0046720852364394],
[            -2.5, -5.08164827727869, -0.00622902548586],
[            -2.4, -4.80392166687067, -0.00823132048231334],
[            -2.3, -4.53526079927315, -0.0107820277390521],
[            -2.2, -4.27561844704414, -0.0140010057593846],
[            -2.1, -4.02494422224398, -0.0180259155577277],
[              -2, -3.78318433368203, -0.0230129093289635],
[            -1.9, -3.55028132554213, -0.0291369478451058],
[            -1.8, -3.32617379637859, -0.0365917039060094],
[            -1.7, -3.11079609755248, -0.0455890291700689],
[            -1.6, -2.90407801030225, -0.0563579843039837],
[            -1.5, -2.70594440082389, -0.069143455612234],
[            -1.4, -2.51631485298833, -0.0842044030301727],
[            -1.3, -2.33510327866244, -0.101811802667655],
[            -1.2, -2.16221750604374, -0.122246360487418],
[            -1.1, -1.9975588469863, -0.145796081317053],
[              -1, -1.84102164500926, -0.17275377902345],
[-0.899999999999999, -1.69249280656134, -0.203414609755747],
[-0.799999999999997, -1.55185131918777, -0.238073701623329],
[-0.699999999999999, -1.41896776153153, -0.277023942277132],
[-0.599999999999998, -1.29370381161403, -0.32055397198752],
[            -0.5, -1.17591176159362, -0.368946415288657],
[-0.399999999999999, -1.06543404918958, -0.422476370227777],
[-0.299999999999997, -0.962102818168848, -0.481410161588483],
[-0.199999999999999, -0.865739522681594, -0.546004353722775],
[-0.0999999999999979, -0.776154592730272, -0.616505010115028],
[               0, -0.693147180559945, -0.693147180559945],
[0.100000000000001, -0.616505010115026, -0.776154592730274],
[0.200000000000003, -0.546004353722772, -0.865739522681598],
[0.300000000000001, -0.481410161588481, -0.962102818168852],
[0.400000000000002, -0.422476370227775, -1.06543404918958],
[             0.5, -0.368946415288657, -1.17591176159362],
[0.600000000000001, -0.320553971987519, -1.29370381161403],
[0.700000000000003, -0.27702394227713, -1.41896776153154],
[0.800000000000001, -0.238073701623328, -1.55185131918778],
[0.900000000000002, -0.203414609755746, -1.69249280656134],
[               1, -0.17275377902345, -1.84102164500926],
[             1.1, -0.145796081317053, -1.9975588469863],
[             1.2, -0.122246360487418, -2.16221750604374],
[             1.3, -0.101811802667655, -2.33510327866244],
[             1.4, -0.0842044030301727, -2.51631485298833],
[             1.5, -0.069143455612234, -2.70594440082389],
[             1.6, -0.0563579843039837, -2.90407801030225],
[             1.7, -0.0455890291700689, -3.11079609755248],
[             1.8, -0.0365917039060094, -3.32617379637859],
[             1.9, -0.0291369478451058, -3.55028132554213],
[               2, -0.0230129093289635, -3.78318433368203],
[             2.1, -0.0180259155577277, -4.02494422224398],
[             2.2, -0.0140010057593846, -4.27561844704414],
[             2.3, -0.0107820277390521, -4.53526079927315],
[             2.4, -0.00823132048231334, -4.80392166687067],
[             2.5, -0.00622902548586, -5.08164827727869],
[             2.6, -0.0046720852364394, -5.36848492262427],
[             2.7, -0.00347299768383746, -5.66447316839644],
[             2.8, -0.00255840024716059, -5.96965204667521],
[             2.9, -0.00186755609818092, -6.28405823494742],
[               3, -0.00135080996474819, -6.60772622151035],
[             3.1, -0.000968071643401549, -6.94068845842123],
[             3.2, -0.00068737412539049, -7.28297550290363],
[             3.3, -0.00048354102950672, -7.63461614807113],
[             3.4, -0.000336986039094691, -7.99563754377665],
[             3.5, -0.000232656141376804, -8.36606530834409],
[             3.6, -0.000159121249272065, -8.7459236318874],
[             3.7, -0.000107805544286263, -9.13523537187288],
[             3.8, -7.23506611710858e-05, -9.53402214153257],
[             3.9, -4.80975006838444e-05, -9.94230439169136],
[               4, -3.16717433774893e-05, -10.3601014865273],
[             4.1, -2.06577202817811e-05, -10.7874317737446],
[             4.2, -1.33458380712071e-05, -11.2243126496011],
[             4.3, -8.53994193619215e-06, -11.6707606191956],
[             4.4, -5.41255855557248e-06, -12.1267913523907],
[             4.5, -3.39767889683447e-06, -12.5924197357131],
[             4.6, -2.11245693373843e-06, -13.0676599205472],
[             4.7, -1.30080829996803e-06, -13.5525253679131],
[             4.8, -7.9332846666054e-07, -14.0470288900935],
[             4.9, -4.79183391398662e-07, -14.5511826893553],
[               5, -2.86651612963764e-07, -15.0649983939887],
[             5.1, -1.69826755135323e-07, -15.5884870918715],
[             5.2, -9.96442681338246e-08, -16.1216593617458],
[             5.3, -5.79013420759286e-08, -16.6645253023825],
[             5.4, -3.33204490405547e-08, -17.2170945597915],
[             5.5, -1.89895626461895e-08, -17.7793763526253],
[             5.6, -1.07175903157443e-08, -18.3513794959093],
[             5.7, -5.9903714190058e-09, -18.9331124232247],
[             5.8, -3.31574598382325e-09, -19.524583207455],
[             5.9, -1.8175078647511e-09, -20.1257995802032],
[               6, -9.86587645524376e-10, -20.7367689499747],
[             6.1, -5.30342326435516e-10, -21.3574984192156],
[             6.2, -2.82315803744178e-10, -21.9879948002866],
[             6.3, -1.48822822187305e-10,  -22.62826463045],
[             6.4, -7.76884758201159e-11, -23.2783141859372],
[             6.5, -4.01600058393976e-11, -23.9381494951618],
[             6.6, -2.05578890942065e-11, -24.6077763511381],
[             6.7, -1.04209769880195e-11, -25.2872003231574],
[             6.8, -5.23095754415828e-12, -25.9764267677755],
[             6.9, -2.60012696564155e-12, -26.6754608391556],
[               7, -1.27981254388665e-12, -27.3843074988111],
[             7.1, -6.23784446333354e-13, -28.1029715247876],
[             7.2, -3.01062798111789e-13, -28.8314575203219],
[             7.3, -1.43883863815769e-13, -29.5697699220113],
[             7.4, -6.80922489062025e-14, -30.3179130075253],
[             7.5, -3.19089167291095e-14,  -31.07589090289],
[             7.6, -1.48065374900482e-14, -31.8437075893706],
[             7.7, -6.80331154077398e-15, -32.6213669099801],
[             7.8, -3.0953587719587e-15, -33.4088725756349],
[             7.9, -1.39451714665927e-15, -34.2062281709817],
[               8, -6.22096057427179e-16, -35.0134371599146],
[             8.1, -2.74795939239823e-16, -35.8305028908015],
[             8.2, -1.20193515427359e-16, -36.6574286014387],
[             8.3, -5.20556974489026e-17, -37.4942174237483],
[             8.4, -2.23239319728804e-17, -38.3408723882352],
[             8.5, -9.47953482220332e-18, -39.1973964282177],
[             8.6, -3.98580496284818e-18, -40.0637923838442],
[             8.7, -1.65942086996478e-18, -40.9400630059101],
[             8.8, -6.84080768593555e-19, -41.8262109594845],
[             8.9, -2.79233437493965e-19, -42.7222388273597],
[               9, -1.12858840595384e-19, -43.6281491133321],
[             9.1, -4.51659149143546e-20, -44.5439442453245],
[             9.2, -1.78974881201405e-20, -45.469626578359],
[             9.3, -7.02228424044163e-21, -46.4051983973889],
[             9.4, -2.72815357134612e-21, -47.3506619199965],
[             9.5, -1.04945150753626e-21, -48.3060192989652],
[             9.6, -3.99722120572624e-22, -49.2712726247324],
[             9.7, -1.5074931688102e-22, -50.2464239277293],
[             9.8, -5.62928231137653e-23, -51.231475180614],
[             9.9, -2.08137521949321e-23, -52.226428300404],
[              10, -7.61985302416053e-24, -53.2312851505125],
[            10.1, -2.76210947176452e-24, -54.2460475426936],
[            10.2, -9.91362512256007e-25, -55.2707172389029],
[            10.3, -3.52306507892641e-25, -56.305295953075],
[            10.4, -1.239665979584e-25, -57.3497853528244],
[            10.5, -4.31900631780923e-26, -58.4041870610732],
[            10.6, -1.48990112729648e-26, -59.4685026576087],
[            10.7, -5.08891085502732e-27, -60.5427336805745],
[            10.8, -1.72101783947978e-27, -61.6268816278996],
[            10.9, -5.76286441383559e-28, -62.7209479586665],
[              11, -1.91065957449868e-28, -63.8249340944237],
[            11.1, -6.27219439321705e-29, -64.938841420443],
[            11.2, -2.03866750354489e-29, -66.062671286926],
[            11.3, -6.56089994090416e-30, -67.1964250101611],
[            11.4, -2.09059542173855e-30, -68.3401038736343],
[            11.5, -6.59577144611367e-31, -69.4937091290954],
[            11.6, -2.06039123615879e-31, -70.6572419975811],
[            11.7, -6.37267491568616e-32, -71.8307036703992],
[            11.8, -1.95155729316955e-32, -73.0140953100728],
[            11.9, -5.91735771630608e-33, -74.2074180512483],
[              12, -1.77648211207768e-33, -75.4106730015688],
[            12.1, -5.28055876743356e-34, -76.6238612425132],
[            12.2, -1.55411978638961e-34, -77.846983830204],
[            12.3, -4.52870695615879e-35, -79.080041796184],
[            12.4, -1.30661798312463e-35, -80.3230361481642],
[            12.5, -3.73256429887771e-36, -81.5759678707439],
[            12.6, -1.05572255808865e-36, -82.8388379261036],
[            12.7, -2.95648536485205e-37, -84.1116472546732],
[            12.8, -8.19756171316293e-38, -85.3943967757747],
[            12.9, -2.25048589341506e-38, -86.6870873882429],
[              13, -6.11716439954988e-39, -87.9897199710225],
[            13.1, -1.64628830695087e-39, -89.3022953837447],
[            13.2, -4.38675271307425e-40, -90.6248144672827],
[            13.3, -1.15734162836903e-40, -91.957278044288],
[            13.4, -3.02315773594517e-41, -93.2996869197074],
[            13.5, -7.81880730565789e-42, -94.6520418812829],
[            13.6, -2.0021672236815e-42, -96.0143437000327],
[            13.7, -5.07621481159788e-43, -97.3865931307175],
[            13.8, -1.27426314550684e-43, -98.7687909122893],
[            13.9, -3.16706826813078e-44, -100.160937768326],
[              14, -7.7935368191928e-45, -101.56303440745],
[            14.1, -1.89884852122918e-45, -102.975081523735],
[            14.2, -4.58062055189479e-46, -104.397079797098],
[            14.3, -1.0940477870189e-46, -105.829029893676],
[            14.4, -2.58717592540225e-47, -107.270932466194],
[            14.5, -6.05749476441522e-48, -108.72278815432],
[            14.6, -1.40422686696265e-48, -110.184597585008],
[            14.7, -3.22298575774484e-49, -111.656361372828],
[            14.8, -7.32413111982709e-50, -113.138080120289],
[            14.9, -1.6478974977e-50, -114.629754418147],
[              15, -3.67096619931275e-51, -116.131384845712],
[            15.1, -8.09666998801522e-52, -117.642971971133],
[            15.2, -1.76810523412223e-52, -119.164516351684],
[            15.3, -3.82283156207345e-53, -120.696018534037],
[            15.4, -8.18346755401425e-54, -122.237479054528],
[            15.5, -1.73446079179387e-54, -123.78889843941],
[            15.6, -3.63970600148676e-55, -125.350277205108],
[            15.7, -7.56210317468378e-56, -126.921615858455],
[            15.8, -1.55558286895012e-56, -128.502914896931],
[            15.9, -3.16823766537965e-57, -130.094174808885],
[              16, -6.38875440053809e-58, -131.69539607376],
[            16.1, -1.27552292445016e-58, -133.306579162304],
[            16.2, -2.52135372531011e-59, -134.927724536778],
[            16.3, -4.93460647706621e-60, -136.558832651159],
[            16.4, -9.56190257423199e-61, -138.199903951333],
[            16.5, -1.83446300316473e-61, -139.850938875285],
[            16.6, -3.48454651995033e-62, -141.511937853285],
[            16.7, -6.55323978194241e-63, -143.182901308066],
[            16.8, -1.22022004059762e-63, -144.863829654997],
[            16.9, -2.24953302305127e-64, -146.554723302254],
[              17, -4.10599620209891e-65, -148.25558265098],
[            17.1, -7.4202150716403e-66, -149.966408095452],
[            17.2, -1.32765750427179e-66, -151.687200023225],
[            17.3, -2.35194445880923e-67, -153.417958815295],
[            17.4, -4.12514626507903e-68, -155.158684846236],
[            17.5, -7.16345876623504e-69, -156.909378484346],
[            17.6, -1.23162116859459e-69, -158.670040091787],
[            17.7, -2.09653605431778e-70, -160.440670024717],
[            17.8, -3.53344377541376e-71, -162.221268633423],
[            17.9, -5.89609597726308e-72, -164.011836262448],
[              18, -9.74094891893715e-73, -165.812373250714],
[            18.1, -1.59333906788398e-73, -167.622879931646],
[            18.2, -2.58038922065181e-74, -169.443356633286],
[            18.3, -4.13744437350469e-75, -171.273803678411],
[            18.4, -6.56823849338697e-76, -173.11422138464],
[            18.5, -1.03236986895633e-76, -174.964610064547],
[            18.6, -1.60653893432569e-77, -176.824970025765],
[            18.7, -2.47523584514254e-78, -178.695301571088],
[            18.8, -3.77581913269241e-79, -180.575604998575],
[            18.9, -5.7026263842317e-80, -182.465880601641],
[              19, -8.52722395263098e-81, -184.366128669161],
[            19.1, -1.26243582218532e-81, -186.276349485555],
[            19.2, -1.85046006994254e-82, -188.196543330883],
[            19.3, -2.68546054279922e-83, -190.126710480934],
[            19.4, -3.85856982898133e-84, -192.066851207306],
[            19.5, -5.48911547566041e-85, -194.016965777497],
[            19.6, -7.73119576813146e-86, -195.977054454985],
[            19.7, -1.07810028636623e-86, -197.947117499304],
[            19.8, -1.48846877588926e-87, -199.927155166125],
[            19.9, -2.03464320878273e-88, -201.917167707333],
[              20, -2.75362411860623e-89, -203.917155371097],
[            20.1, -3.68968086372139e-90, -205.927118401948],
[            20.2, -4.89486365476525e-91, -207.947057040844],
[            20.3, -6.42924446769835e-92, -209.976971525242],
[            20.4, -8.3607786213281e-93, -212.016862089164],
[            20.5, -1.0764673258791e-93, -214.066728963264],
[            20.6, -1.37221519757791e-94, -216.12657237489],
[            20.7, -1.73185187901974e-95, -218.196392548148],
[            20.8, -2.16404514688054e-96, -220.276189703963],
[            20.9, -2.67724949663741e-97, -222.365964060138],
[              21, -3.27927801897904e-98, -224.465715831414],
[            21.1, -3.97680596952967e-99, -226.575445229525],
[            21.2, -4.77482267039508e-100, -228.695152463252],
[            21.3, -5.67605616213548e-101, -230.824837738482],
[            21.4, -6.6804024125533e-102, -232.964501258258],
[            21.5, -7.78439707718263e-103, -235.114143222833],
[            21.6, -8.98077194814038e-104, -237.273763829717],
[            21.7, -1.02581395269687e-104, -239.443363273729],
[            21.8, -1.16008469725442e-105, -241.622941747047],
[            21.9, -1.29890346246158e-106, -243.812499439254],
[              22, -1.43989243514508e-107, -246.012036537381]
      ].forEach(function(pair) {
         var x, mu, sigma, logp, rlogp, rlogq, xfromqnorm;
         mu = Math.random() * 50 - 50;
         sigma = Math.random() * 10 + 0.0001;
         x = pair[0];
         rlogp = pair[1];
         rlogq = pair[2];
         logp = normal.pnorm(0, 1, true, true)(x);
         logq = normal.pnorm(0, 1, false, true)(x);
         expect(utils.relativelyCloseTo(logp, rlogp, precision)).to.be.ok;
         expect(utils.relativelyCloseTo(
            normal.pnorm(mu, sigma, true, true)(mu + sigma * x), rlogp, precision)).to.be.ok;
         expect(utils.relativelyCloseTo(logq, rlogq, precision)).to.be.ok;
         if (x !== 0) {
            expect(utils.relativelyCloseTo(
               normal.qnorm(0, 1, true, true)(rlogp), x, precision)).to.be.ok;
            expect(utils.relativelyCloseTo(
               normal.qnorm(0, 1, false, true)(rlogq), x, precision)).to.be.ok;
            expect(utils.relativelyCloseTo(
               normal.qnorm(mu, sigma, false, true)(rlogq), mu + sigma * x, precision)).to.be.ok;
         }
      });
   });
   it('normal also exported as an object', function() {
      var o;
      o = main.normal(.1, .3);
      ['d', 'p', 'q', 'r'].forEach(function(s) {
         expect(o).to.respondTo(s);
         if (s !== 'r') {
            expect(o[s](.2)).to.equal(main[s + 'norm'](.1, .3)(.2));
         }
      });
   });
   /* Rcode generating the tests:
      options(digits = 20)
      x = c(NaN, -Inf, -1.3, 1.5, Inf)
      mu = c(NaN, -Inf, -1.3, 1.5, Inf)
      sigma = c(NaN, -Inf, -1, 0, 3.7, Inf)
      g = expand.grid(x=x, mu=mu, sigma=sigma)
      g$d = dnorm(g$x, g$mu, g$sigma, log=TRUE)
      g$p = pnorm(g$x, g$mu, g$sigma, log.p=TRUE)
      g$q = pnorm(g$x, g$mu, g$sigma, lower.tail=FALSE, log.p=TRUE)
      s = paste(g$x, g$mu, g$sigma, g$d, g$p, g$q, sep=", ", collapse="],\n[")
      s = paste("[", s, "]", sep="")
   */
   it('pnorm, dnorm handle inappropriate inputs and dnorm scales with sigma', function() {
      [
   [NaN, NaN, NaN, NaN, NaN, NaN],
   [-Infinity, NaN, NaN, NaN, NaN, NaN],
   [-1.3, NaN, NaN, NaN, NaN, NaN],
   [1.5, NaN, NaN, NaN, NaN, NaN],
   [Infinity, NaN, NaN, NaN, NaN, NaN],
   [NaN, -Infinity, NaN, NaN, NaN, NaN],
   [-Infinity, -Infinity, NaN, NaN, NaN, NaN],
   [-1.3, -Infinity, NaN, NaN, NaN, NaN],
   [1.5, -Infinity, NaN, NaN, NaN, NaN],
   [Infinity, -Infinity, NaN, NaN, NaN, NaN],
   [NaN, -1.3, NaN, NaN, NaN, NaN],
   [-Infinity, -1.3, NaN, NaN, NaN, NaN],
   [-1.3, -1.3, NaN, NaN, NaN, NaN],
   [1.5, -1.3, NaN, NaN, NaN, NaN],
   [Infinity, -1.3, NaN, NaN, NaN, NaN],
   [NaN, 1.5, NaN, NaN, NaN, NaN],
   [-Infinity, 1.5, NaN, NaN, NaN, NaN],
   [-1.3, 1.5, NaN, NaN, NaN, NaN],
   [1.5, 1.5, NaN, NaN, NaN, NaN],
   [Infinity, 1.5, NaN, NaN, NaN, NaN],
   [NaN, Infinity, NaN, NaN, NaN, NaN],
   [-Infinity, Infinity, NaN, NaN, NaN, NaN],
   [-1.3, Infinity, NaN, NaN, NaN, NaN],
   [1.5, Infinity, NaN, NaN, NaN, NaN],
   [Infinity, Infinity, NaN, NaN, NaN, NaN],
   [NaN, NaN, -Infinity, NaN, NaN, NaN],
   [-Infinity, NaN, -Infinity, NaN, NaN, NaN],
   [-1.3, NaN, -Infinity, NaN, NaN, NaN],
   [1.5, NaN, -Infinity, NaN, NaN, NaN],
   [Infinity, NaN, -Infinity, NaN, NaN, NaN],
   [NaN, -Infinity, -Infinity, NaN, NaN, NaN],
   [-Infinity, -Infinity, -Infinity, -Infinity, NaN, NaN],
   [-1.3, -Infinity, -Infinity, -Infinity, NaN, NaN],
   [1.5, -Infinity, -Infinity, -Infinity, NaN, NaN],
   [Infinity, -Infinity, -Infinity, -Infinity, NaN, NaN],
   [NaN, -1.3, -Infinity, NaN, NaN, NaN],
   [-Infinity, -1.3, -Infinity, -Infinity, NaN, NaN],
   [-1.3, -1.3, -Infinity, -Infinity, NaN, NaN],
   [1.5, -1.3, -Infinity, -Infinity, NaN, NaN],
   [Infinity, -1.3, -Infinity, -Infinity, NaN, NaN],
   [NaN, 1.5, -Infinity, NaN, NaN, NaN],
   [-Infinity, 1.5, -Infinity, -Infinity, NaN, NaN],
   [-1.3, 1.5, -Infinity, -Infinity, NaN, NaN],
   [1.5, 1.5, -Infinity, -Infinity, NaN, NaN],
   [Infinity, 1.5, -Infinity, -Infinity, NaN, NaN],
   [NaN, Infinity, -Infinity, NaN, NaN, NaN],
   [-Infinity, Infinity, -Infinity, -Infinity, NaN, NaN],
   [-1.3, Infinity, -Infinity, -Infinity, NaN, NaN],
   [1.5, Infinity, -Infinity, -Infinity, NaN, NaN],
   [Infinity, Infinity, -Infinity, -Infinity, NaN, NaN],
   [NaN, NaN, -1, NaN, NaN, NaN],
   [-Infinity, NaN, -1, NaN, NaN, NaN],
   [-1.3, NaN, -1, NaN, NaN, NaN],
   [1.5, NaN, -1, NaN, NaN, NaN],
   [Infinity, NaN, -1, NaN, NaN, NaN],
   [NaN, -Infinity, -1, NaN, NaN, NaN],
   [-Infinity, -Infinity, -1, NaN, NaN, NaN],
   [-1.3, -Infinity, -1, NaN, NaN, NaN],
   [1.5, -Infinity, -1, NaN, NaN, NaN],
   [Infinity, -Infinity, -1, NaN, NaN, NaN],
   [NaN, -1.3, -1, NaN, NaN, NaN],
   [-Infinity, -1.3, -1, NaN, NaN, NaN],
   [-1.3, -1.3, -1, NaN, NaN, NaN],
   [1.5, -1.3, -1, NaN, NaN, NaN],
   [Infinity, -1.3, -1, NaN, NaN, NaN],
   [NaN, 1.5, -1, NaN, NaN, NaN],
   [-Infinity, 1.5, -1, NaN, NaN, NaN],
   [-1.3, 1.5, -1, NaN, NaN, NaN],
   [1.5, 1.5, -1, NaN, NaN, NaN],
   [Infinity, 1.5, -1, NaN, NaN, NaN],
   [NaN, Infinity, -1, NaN, NaN, NaN],
   [-Infinity, Infinity, -1, NaN, NaN, NaN],
   [-1.3, Infinity, -1, NaN, NaN, NaN],
   [1.5, Infinity, -1, NaN, NaN, NaN],
   [Infinity, Infinity, -1, NaN, NaN, NaN],
   [NaN, NaN, 0, NaN, NaN, NaN],
   [-Infinity, NaN, 0, NaN, NaN, NaN],
   [-1.3, NaN, 0, NaN, NaN, NaN],
   [1.5, NaN, 0, NaN, NaN, NaN],
   [Infinity, NaN, 0, NaN, NaN, NaN],
   [NaN, -Infinity, 0, NaN, NaN, NaN],
   [-Infinity, -Infinity, 0, NaN, NaN, NaN],
   [-1.3, -Infinity, 0, -Infinity, 0, -Infinity],
   [1.5, -Infinity, 0, -Infinity, 0, -Infinity],
   [Infinity, -Infinity, 0, -Infinity, 0, -Infinity],
   [NaN, -1.3, 0, NaN, NaN, NaN],
   [-Infinity, -1.3, 0, -Infinity, -Infinity, 0],
   [-1.3, -1.3, 0, Infinity, 0, -Infinity],
   [1.5, -1.3, 0, -Infinity, 0, -Infinity],
   [Infinity, -1.3, 0, -Infinity, 0, -Infinity],
   [NaN, 1.5, 0, NaN, NaN, NaN],
   [-Infinity, 1.5, 0, -Infinity, -Infinity, 0],
   [-1.3, 1.5, 0, -Infinity, -Infinity, 0],
   [1.5, 1.5, 0, Infinity, 0, -Infinity],
   [Infinity, 1.5, 0, -Infinity, 0, -Infinity],
   [NaN, Infinity, 0, NaN, NaN, NaN],
   [-Infinity, Infinity, 0, -Infinity, -Infinity, 0],
   [-1.3, Infinity, 0, -Infinity, -Infinity, 0],
   [1.5, Infinity, 0, -Infinity, -Infinity, 0],
   [Infinity, Infinity, 0, NaN, NaN, NaN],
   [NaN, NaN, 3.7, NaN, NaN, NaN],
   [-Infinity, NaN, 3.7, NaN, NaN, NaN],
   [-1.3, NaN, 3.7, NaN, NaN, NaN],
   [1.5, NaN, 3.7, NaN, NaN, NaN],
   [Infinity, NaN, 3.7, NaN, NaN, NaN],
   [NaN, -Infinity, 3.7, NaN, NaN, NaN],
   [-Infinity, -Infinity, 3.7, NaN, NaN, NaN],
   [-1.3, -Infinity, 3.7, -Infinity, 0, -Infinity],
   [1.5, -Infinity, 3.7, -Infinity, 0, -Infinity],
   [Infinity, -Infinity, 3.7, -Infinity, 0, -Infinity],
   [NaN, -1.3, 3.7, NaN, NaN, NaN],
   [-Infinity, -1.3, 3.7, -Infinity, -Infinity, 0],
   [-1.3, -1.3, 3.7, -2.22727135285485, -0.693147180559945, -0.693147180559945],
   [1.5, -1.3, 3.7, -2.51361174730335, -0.254373419398362, -1.49344402192485],
   [Infinity, -1.3, 3.7, -Infinity, 0, -Infinity],
   [NaN, 1.5, 3.7, NaN, NaN, NaN],
   [-Infinity, 1.5, 3.7, -Infinity, -Infinity, 0],
   [-1.3, 1.5, 3.7, -2.51361174730335, -1.49344402192485, -0.254373419398362],
   [1.5, 1.5, 3.7, -2.22727135285485, -0.693147180559945, -0.693147180559945],
   [Infinity, 1.5, 3.7, -Infinity, 0, -Infinity],
   [NaN, Infinity, 3.7, NaN, NaN, NaN],
   [-Infinity, Infinity, 3.7, -Infinity, -Infinity, 0],
   [-1.3, Infinity, 3.7, -Infinity, -Infinity, 0],
   [1.5, Infinity, 3.7, -Infinity, -Infinity, 0],
   [Infinity, Infinity, 3.7, NaN, NaN, NaN],
   [NaN, NaN, Infinity, NaN, NaN, NaN],
   [-Infinity, NaN, Infinity, NaN, NaN, NaN],
   [-1.3, NaN, Infinity, NaN, NaN, NaN],
   [1.5, NaN, Infinity, NaN, NaN, NaN],
   [Infinity, NaN, Infinity, NaN, NaN, NaN],
   [NaN, -Infinity, Infinity, NaN, NaN, NaN],
   [-Infinity, -Infinity, Infinity, -Infinity, NaN, NaN],
   [-1.3, -Infinity, Infinity, -Infinity, 0, -Infinity],
   [1.5, -Infinity, Infinity, -Infinity, 0, -Infinity],
   [Infinity, -Infinity, Infinity, -Infinity, 0, -Infinity],
   [NaN, -1.3, Infinity, NaN, NaN, NaN],
   [-Infinity, -1.3, Infinity, -Infinity, -Infinity, 0],
   [-1.3, -1.3, Infinity, -Infinity, -0.693147180559945, -0.693147180559945],
   [1.5, -1.3, Infinity, -Infinity, -0.693147180559945, -0.693147180559945],
   [Infinity, -1.3, Infinity, -Infinity, 0, -Infinity],
   [NaN, 1.5, Infinity, NaN, NaN, NaN],
   [-Infinity, 1.5, Infinity, -Infinity, -Infinity, 0],
   [-1.3, 1.5, Infinity, -Infinity, -0.693147180559945, -0.693147180559945],
   [1.5, 1.5, Infinity, -Infinity, -0.693147180559945, -0.693147180559945],
   [Infinity, 1.5, Infinity, -Infinity, 0, -Infinity],
   [NaN, Infinity, Infinity, NaN, NaN, NaN],
   [-Infinity, Infinity, Infinity, -Infinity, -Infinity, 0],
   [-1.3, Infinity, Infinity, -Infinity, -Infinity, 0],
   [1.5, Infinity, Infinity, -Infinity, -Infinity, 0],
   [Infinity, Infinity, Infinity, -Infinity, NaN, NaN]
      ].forEach(function(tuple) {
         var x, mu, sigma, rlogp, rlogq, rlogd, logp, logq, logd;
         x = tuple[0];
         mu = tuple[1];
         sigma = tuple[2];
         rlogd = tuple[3];
         rlogp = tuple[4];
         rlogq = tuple[5];
         logp = main.pnorm(mu, sigma, true, true)(x);
         logq = main.pnorm(mu, sigma, false, true)(x);
         logd = main.dnorm(mu, sigma, true)(x);
         expect(utils.relativelyCloseTo(logp, rlogp)).to.equal(true);
         expect(utils.relativelyCloseTo(logq, rlogq)).to.equal(true);
         expect(utils.relativelyCloseTo(logd, rlogd)).to.equal(true);
      });
   });

   /* Rcode generating the tests:
      options(digits = 20)
      p = c(NaN, -Inf, -1, 0, 0.3, 1, Inf)
      mu = c(NaN, -Inf, -1.3, 1.5, Inf)
      sigma = c(NaN, -Inf, -1, 0, 3.7, Inf)
      g = expand.grid(p=p, mu=mu, sigma=sigma)
      g$x1 = qnorm(g$p, g$mu, g$sigma, lower.tail=TRUE, log.p=TRUE)
      g$x2 = qnorm(g$p, g$mu, g$sigma, lower.tail=FALSE, log.p=TRUE)
      s = paste(g$p, g$mu, g$sigma, g$x1, g$x2, sep=", ", collapse="],\n[")
      s = paste("[", s, "]", sep="")
   */
   it('qnorm handles inappropriate inputs', function() {
      [
   [NaN, NaN, NaN, NaN, NaN],
   [-Infinity, NaN, NaN, NaN, NaN],
   [-1, NaN, NaN, NaN, NaN],
   [0, NaN, NaN, NaN, NaN],
   [0.3, NaN, NaN, NaN, NaN],
   [1, NaN, NaN, NaN, NaN],
   [Infinity, NaN, NaN, NaN, NaN],
   [NaN, -Infinity, NaN, NaN, NaN],
   [-Infinity, -Infinity, NaN, NaN, NaN],
   [-1, -Infinity, NaN, NaN, NaN],
   [0, -Infinity, NaN, NaN, NaN],
   [0.3, -Infinity, NaN, NaN, NaN],
   [1, -Infinity, NaN, NaN, NaN],
   [Infinity, -Infinity, NaN, NaN, NaN],
   [NaN, -1.3, NaN, NaN, NaN],
   [-Infinity, -1.3, NaN, NaN, NaN],
   [-1, -1.3, NaN, NaN, NaN],
   [0, -1.3, NaN, NaN, NaN],
   [0.3, -1.3, NaN, NaN, NaN],
   [1, -1.3, NaN, NaN, NaN],
   [Infinity, -1.3, NaN, NaN, NaN],
   [NaN, 1.5, NaN, NaN, NaN],
   [-Infinity, 1.5, NaN, NaN, NaN],
   [-1, 1.5, NaN, NaN, NaN],
   [0, 1.5, NaN, NaN, NaN],
   [0.3, 1.5, NaN, NaN, NaN],
   [1, 1.5, NaN, NaN, NaN],
   [Infinity, 1.5, NaN, NaN, NaN],
   [NaN, Infinity, NaN, NaN, NaN],
   [-Infinity, Infinity, NaN, NaN, NaN],
   [-1, Infinity, NaN, NaN, NaN],
   [0, Infinity, NaN, NaN, NaN],
   [0.3, Infinity, NaN, NaN, NaN],
   [1, Infinity, NaN, NaN, NaN],
   [Infinity, Infinity, NaN, NaN, NaN],
   [NaN, NaN, -Infinity, NaN, NaN],
   [-Infinity, NaN, -Infinity, NaN, NaN],
   [-1, NaN, -Infinity, NaN, NaN],
   [0, NaN, -Infinity, NaN, NaN],
   [0.3, NaN, -Infinity, NaN, NaN],
   [1, NaN, -Infinity, NaN, NaN],
   [Infinity, NaN, -Infinity, NaN, NaN],
   [NaN, -Infinity, -Infinity, NaN, NaN],
   [-Infinity, -Infinity, -Infinity, -Infinity, Infinity],
   [-1, -Infinity, -Infinity, NaN, NaN],
   [0, -Infinity, -Infinity, Infinity, -Infinity],
   [0.3, -Infinity, -Infinity, NaN, NaN],
   [1, -Infinity, -Infinity, NaN, NaN],
   [Infinity, -Infinity, -Infinity, NaN, NaN],
   [NaN, -1.3, -Infinity, NaN, NaN],
   [-Infinity, -1.3, -Infinity, -Infinity, Infinity],
   [-1, -1.3, -Infinity, NaN, NaN],
   [0, -1.3, -Infinity, Infinity, -Infinity],
   [0.3, -1.3, -Infinity, NaN, NaN],
   [1, -1.3, -Infinity, NaN, NaN],
   [Infinity, -1.3, -Infinity, NaN, NaN],
   [NaN, 1.5, -Infinity, NaN, NaN],
   [-Infinity, 1.5, -Infinity, -Infinity, Infinity],
   [-1, 1.5, -Infinity, NaN, NaN],
   [0, 1.5, -Infinity, Infinity, -Infinity],
   [0.3, 1.5, -Infinity, NaN, NaN],
   [1, 1.5, -Infinity, NaN, NaN],
   [Infinity, 1.5, -Infinity, NaN, NaN],
   [NaN, Infinity, -Infinity, NaN, NaN],
   [-Infinity, Infinity, -Infinity, -Infinity, Infinity],
   [-1, Infinity, -Infinity, NaN, NaN],
   [0, Infinity, -Infinity, Infinity, -Infinity],
   [0.3, Infinity, -Infinity, NaN, NaN],
   [1, Infinity, -Infinity, NaN, NaN],
   [Infinity, Infinity, -Infinity, NaN, NaN],
   [NaN, NaN, -1, NaN, NaN],
   [-Infinity, NaN, -1, NaN, NaN],
   [-1, NaN, -1, NaN, NaN],
   [0, NaN, -1, NaN, NaN],
   [0.3, NaN, -1, NaN, NaN],
   [1, NaN, -1, NaN, NaN],
   [Infinity, NaN, -1, NaN, NaN],
   [NaN, -Infinity, -1, NaN, NaN],
   [-Infinity, -Infinity, -1, -Infinity, Infinity],
   [-1, -Infinity, -1, NaN, NaN],
   [0, -Infinity, -1, Infinity, -Infinity],
   [0.3, -Infinity, -1, NaN, NaN],
   [1, -Infinity, -1, NaN, NaN],
   [Infinity, -Infinity, -1, NaN, NaN],
   [NaN, -1.3, -1, NaN, NaN],
   [-Infinity, -1.3, -1, -Infinity, Infinity],
   [-1, -1.3, -1, NaN, NaN],
   [0, -1.3, -1, Infinity, -Infinity],
   [0.3, -1.3, -1, NaN, NaN],
   [1, -1.3, -1, NaN, NaN],
   [Infinity, -1.3, -1, NaN, NaN],
   [NaN, 1.5, -1, NaN, NaN],
   [-Infinity, 1.5, -1, -Infinity, Infinity],
   [-1, 1.5, -1, NaN, NaN],
   [0, 1.5, -1, Infinity, -Infinity],
   [0.3, 1.5, -1, NaN, NaN],
   [1, 1.5, -1, NaN, NaN],
   [Infinity, 1.5, -1, NaN, NaN],
   [NaN, Infinity, -1, NaN, NaN],
   [-Infinity, Infinity, -1, -Infinity, Infinity],
   [-1, Infinity, -1, NaN, NaN],
   [0, Infinity, -1, Infinity, -Infinity],
   [0.3, Infinity, -1, NaN, NaN],
   [1, Infinity, -1, NaN, NaN],
   [Infinity, Infinity, -1, NaN, NaN],
   [NaN, NaN, 0, NaN, NaN],
   [-Infinity, NaN, 0, NaN, NaN],
   [-1, NaN, 0, NaN, NaN],
   [0, NaN, 0, NaN, NaN],
   [0.3, NaN, 0, NaN, NaN],
   [1, NaN, 0, NaN, NaN],
   [Infinity, NaN, 0, NaN, NaN],
   [NaN, -Infinity, 0, NaN, NaN],
   [-Infinity, -Infinity, 0, -Infinity, Infinity],
   [-1, -Infinity, 0, -Infinity, -Infinity],
   [0, -Infinity, 0, Infinity, -Infinity],
   [0.3, -Infinity, 0, NaN, NaN],
   [1, -Infinity, 0, NaN, NaN],
   [Infinity, -Infinity, 0, NaN, NaN],
   [NaN, -1.3, 0, NaN, NaN],
   [-Infinity, -1.3, 0, -Infinity, Infinity],
   [-1, -1.3, 0, -1.3, -1.3],
   [0, -1.3, 0, Infinity, -Infinity],
   [0.3, -1.3, 0, NaN, NaN],
   [1, -1.3, 0, NaN, NaN],
   [Infinity, -1.3, 0, NaN, NaN],
   [NaN, 1.5, 0, NaN, NaN],
   [-Infinity, 1.5, 0, -Infinity, Infinity],
   [-1, 1.5, 0, 1.5, 1.5],
   [0, 1.5, 0, Infinity, -Infinity],
   [0.3, 1.5, 0, NaN, NaN],
   [1, 1.5, 0, NaN, NaN],
   [Infinity, 1.5, 0, NaN, NaN],
   [NaN, Infinity, 0, NaN, NaN],
   [-Infinity, Infinity, 0, -Infinity, Infinity],
   [-1, Infinity, 0, Infinity, Infinity],
   [0, Infinity, 0, Infinity, -Infinity],
   [0.3, Infinity, 0, NaN, NaN],
   [1, Infinity, 0, NaN, NaN],
   [Infinity, Infinity, 0, NaN, NaN],
   [NaN, NaN, 3.7, NaN, NaN],
   [-Infinity, NaN, 3.7, NaN, NaN],
   [-1, NaN, 3.7, NaN, NaN],
   [0, NaN, 3.7, NaN, NaN],
   [0.3, NaN, 3.7, NaN, NaN],
   [1, NaN, 3.7, NaN, NaN],
   [Infinity, NaN, 3.7, NaN, NaN],
   [NaN, -Infinity, 3.7, NaN, NaN],
   [-Infinity, -Infinity, 3.7, -Infinity, Infinity],
   [-1, -Infinity, 3.7, -Infinity, -Infinity],
   [0, -Infinity, 3.7, Infinity, -Infinity],
   [0.3, -Infinity, 3.7, NaN, NaN],
   [1, -Infinity, 3.7, NaN, NaN],
   [Infinity, -Infinity, 3.7, NaN, NaN],
   [NaN, -1.3, 3.7, NaN, NaN],
   [-Infinity, -1.3, 3.7, -Infinity, Infinity],
   [-1, -1.3, 3.7, -2.54865736592755, -0.051342634072451],
   [0, -1.3, 3.7, Infinity, -Infinity],
   [0.3, -1.3, 3.7, NaN, NaN],
   [1, -1.3, 3.7, NaN, NaN],
   [Infinity, -1.3, 3.7, NaN, NaN],
   [NaN, 1.5, 3.7, NaN, NaN],
   [-Infinity, 1.5, 3.7, -Infinity, Infinity],
   [-1, 1.5, 3.7, 0.251342634072451, 2.74865736592755],
   [0, 1.5, 3.7, Infinity, -Infinity],
   [0.3, 1.5, 3.7, NaN, NaN],
   [1, 1.5, 3.7, NaN, NaN],
   [Infinity, 1.5, 3.7, NaN, NaN],
   [NaN, Infinity, 3.7, NaN, NaN],
   [-Infinity, Infinity, 3.7, -Infinity, Infinity],
   [-1, Infinity, 3.7, Infinity, Infinity],
   [0, Infinity, 3.7, Infinity, -Infinity],
   [0.3, Infinity, 3.7, NaN, NaN],
   [1, Infinity, 3.7, NaN, NaN],
   [Infinity, Infinity, 3.7, NaN, NaN],
   [NaN, NaN, Infinity, NaN, NaN],
   [-Infinity, NaN, Infinity, NaN, NaN],
   [-1, NaN, Infinity, NaN, NaN],
   [0, NaN, Infinity, NaN, NaN],
   [0.3, NaN, Infinity, NaN, NaN],
   [1, NaN, Infinity, NaN, NaN],
   [Infinity, NaN, Infinity, NaN, NaN],
   [NaN, -Infinity, Infinity, NaN, NaN],
   [-Infinity, -Infinity, Infinity, -Infinity, Infinity],
   [-1, -Infinity, Infinity, -Infinity, NaN],
   [0, -Infinity, Infinity, Infinity, -Infinity],
   [0.3, -Infinity, Infinity, NaN, NaN],
   [1, -Infinity, Infinity, NaN, NaN],
   [Infinity, -Infinity, Infinity, NaN, NaN],
   [NaN, -1.3, Infinity, NaN, NaN],
   [-Infinity, -1.3, Infinity, -Infinity, Infinity],
   [-1, -1.3, Infinity, -Infinity, Infinity],
   [0, -1.3, Infinity, Infinity, -Infinity],
   [0.3, -1.3, Infinity, NaN, NaN],
   [1, -1.3, Infinity, NaN, NaN],
   [Infinity, -1.3, Infinity, NaN, NaN],
   [NaN, 1.5, Infinity, NaN, NaN],
   [-Infinity, 1.5, Infinity, -Infinity, Infinity],
   [-1, 1.5, Infinity, -Infinity, Infinity],
   [0, 1.5, Infinity, Infinity, -Infinity],
   [0.3, 1.5, Infinity, NaN, NaN],
   [1, 1.5, Infinity, NaN, NaN],
   [Infinity, 1.5, Infinity, NaN, NaN],
   [NaN, Infinity, Infinity, NaN, NaN],
   [-Infinity, Infinity, Infinity, -Infinity, Infinity],
   [-1, Infinity, Infinity, NaN, Infinity],
   [0, Infinity, Infinity, Infinity, -Infinity],
   [0.3, Infinity, Infinity, NaN, NaN],
   [1, Infinity, Infinity, NaN, NaN],
   [Infinity, Infinity, Infinity, NaN, NaN]
      ].forEach(function(tuple) {
         var p, mu, sigma, x1r, x2r, x1, x2;
         p = tuple[0];
         mu = tuple[1];
         sigma = tuple[2];
         x1r = tuple[3];
         x2r = tuple[4];
         x1 = main.qnorm(mu, sigma, true, true)(p);
         x2 = main.qnorm(mu, sigma, false, true)(p);
         expect(utils.relativelyCloseTo(x1r, x1)).to.equal(true);
         expect(utils.relativelyCloseTo(x2r, x2)).to.equal(true);
      });
   });
});

